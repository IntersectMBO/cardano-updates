<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-updates">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">54 posts tagged with &quot;performance-tracing&quot; | Cardano Development Updates</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://updates.cardano.intersectmbo.org/tags/performance-tracing/page/2"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="54 posts tagged with &quot;performance-tracing&quot; | Cardano Development Updates"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://updates.cardano.intersectmbo.org/tags/performance-tracing/page/2"><link data-rh="true" rel="alternate" href="https://updates.cardano.intersectmbo.org/tags/performance-tracing/page/2" hreflang="en"><link data-rh="true" rel="alternate" href="https://updates.cardano.intersectmbo.org/tags/performance-tracing/page/2" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Cardano Updates Feed RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Cardano Updates Feed Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="Cardano Updates Feed JSON Feed">



<link rel="alternate" type="application/rss+xml" href="/quarterly/rss.xml" title="Cardano Development Updates RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/quarterly/atom.xml" title="Cardano Development Updates Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/reports/rss.xml" title="Cardano Development Updates RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/reports/atom.xml" title="Cardano Development Updates Atom Feed">

<script src="https://plausible.io/js/script.js" defer="defer" data-domain="updates.cardano.intersectmbo.org"></script><link rel="stylesheet" href="/assets/css/styles.5c10ca85.css">
<link rel="preload" href="/assets/js/runtime~main.a4621276.js" as="script">
<link rel="preload" href="/assets/js/main.40817c1a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Cardano Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Cardano Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Cardano Updates</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Home</a><a class="navbar__item navbar__link" href="/quarterly">Quarterly</a><a class="navbar__item navbar__link" href="/reports">Reports</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/tags">Topics</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/tags">All Topics</a></li><li><a class="dropdown__link" href="/tags/network">Network</a></li><li><a class="dropdown__link" href="/tags/consensus">Consensus</a></li><li><a class="dropdown__link" href="/tags/ledger">Ledger</a></li><li><a class="dropdown__link" href="/tags/hydra">Hydra</a></li><li><a class="dropdown__link" href="/tags/db-sync">DB Sync</a></li><li><a class="dropdown__link" href="/tags/cli-api">Node CLI &amp; API</a></li><li><a class="dropdown__link" href="/quarterly/tags/cli-api-quarterly">Node CLI &amp; API Quarterly</a></li><li><a class="dropdown__link" href="/tags/crypto">Crypto</a></li><li><a class="dropdown__link" href="/tags/goedel">Goedel</a></li><li><a class="dropdown__link" href="/tags/mithril">Mithril</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/tags/performance-tracing">Performance &amp; Tracing</a></li><li><a class="dropdown__link" href="/reports/tags/benchmarking-reports">Benchmarking Reports</a></li><li><a class="dropdown__link" href="/tags/incident">Incident Reports</a></li><li><a class="dropdown__link" href="/tags/security">Security Reports</a></li></ul></div><a class="navbar__item navbar__link" href="/archive">Archive</a><a href="https://updates.cardano.intersectmbo.org" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent Posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-29-consensus">Consensus Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-29-ledger">Ledger Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-29-mithril">Mithril Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-27-performance-and-tracing">Performance &amp; Tracing Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-24-network">Network Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-22-mithril">Mithril Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-17-hydra">Hydra Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-15-mithril">Mithril Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-14-consensus">Consensus Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-10-sre">SRE Team Update</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><header class="margin-bottom--xl"><h1>54 posts tagged with &quot;performance-tracing&quot;</h1><a href="/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/2025-04-15-performance-and-tracing">Performance &amp; Tracing Update</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2025-04-15T00:00:00.000Z" itemprop="datePublished">April 15, 2025</time> Â· <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/mgmeier" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/mgmeier.png" alt="Michael Karg"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/mgmeier" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Michael Karg</span></a></div><small class="avatar__subtitle" itemprop="description">Performance and Tracing Team Lead</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="high-level-summary">High level summary<a class="hash-link" href="#high-level-summary" title="Direct link to heading">â</a></h2><ul><li><strong>Benchmarking</strong>: <code>10.3.1</code> release benchmarks.</li><li><strong>Development</strong>: Plutus script calibration tool and profile maintenance updates about to be merged.</li><li><strong>Infrastructure</strong>: Workbench simplification about to be merged.</li><li><strong>New Tracing</strong>: System dependencies untangled; preparing &#x27;Periodic tracer&#x27; feature for production.</li><li><strong>Node Diversity</strong>: Participation in Conformance Testing workshop in Paris.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="low-level-overview">Low level overview<a class="hash-link" href="#low-level-overview" title="Direct link to heading">â</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="benchmarking">Benchmarking<a class="hash-link" href="#benchmarking" title="Direct link to heading">â</a></h3><p>We&#x27;re currently running release benchmarks for the upcoming Node <code>10.3.1</code> version - a candidate for Mainnet release. Having taken previous measurements on the release integration branch, we expect the results to be closely aligned with these.  </p><p>Node <code>10.3.1</code> will support two compiler versions, namely GHC8.10.7 and GHC9.6.5. As a consequence, we benchmark both Node builds and compare against the previous performance baseline <code>10.2</code>. So far, the release benchmarks confirm
performance improvements in both resource usage and block production metrics seen on the integration branch - for both compiler versions. A final report will be published on <a href="https://updates.cardano.intersectmbo.org/reports" target="_blank" rel="noopener noreferrer">Cardano Updates</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="development">Development<a class="hash-link" href="#development" title="Direct link to heading">â</a></h3><p>The first version of our new tool <code>calibrate-script</code> is about to be merged. It is part of the <code>tx-generator</code> project, and calibrates Plutus benchmarking scripts according to a range of constraints on the expected workload. The tool
documents the result and all intermediate steps in a developer-friendly way. A CSV report is generated which shows all properties of some calibration at a glance: How much execution budget was given, and how much of each execution budget was used,
was memory or CPU steps the limiting factor for the script, how large will the resulting transaction be and what will it cost and more. Apart from greatly speeding up development of Plutus benchmarks for our team, this tool can also be used to assess
changes to Plutus cost models, or efficiency of different Plutus compiler outputs - without running a full benchmark.  </p><p>Furthermore, the benchmarking profiles defined in <code>cardano-profile</code> have undergone a large maintenance cycle. Besides a cleanup, several profiles were fixed wrt. transaction fees or duration, others now run on a more appropriate performance baseline.
There era-dependency of a profile requiring a minimum protocol version has been solved such that it&#x27;s now impossible to construct incompatible profiles by definition - e.g. a <code>PlutusV3</code> benchmark in any era prior to Conway. The correspondig PR is about to be merged
shortly.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="infrastructure">Infrastructure<a class="hash-link" href="#infrastructure" title="Direct link to heading">â</a></h3><p>A large PR simplifying the build of our performance workbench has been finalized and passed testing. The nix code has been greatly optimized to avoid redundant derivations and creating an abundance of nix store paths. This not only makes the workbench
better maintainable, it greatly reduces time and size requirements for CI jobs. In testing, we could observe a speedup of 40% - 50% for CI. Additionally, this PR prepares for the future removal of GHC8.10 as a release compiler - which will reduce CI
cost even more. The PR is currently under review and to be merged soon.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="new-tracing">New Tracing<a class="hash-link" href="#new-tracing" title="Direct link to heading">â</a></h3><p>The work on untangling dependencies in the new tracing system has entered testing phase. The <code>cardano-tracer</code> service no longer depends on the Node - with common data types and typeclass instances having been refactored to a more basic package of the
tracing system. Once merged, this will allow for the service to be built, released and operated independently of <code>cardano-node</code>, widening its range of use cases.  </p><p>On Node 10.1, we&#x27;ve built a prototype of the &#x27;Periodic tracer&#x27; feature. It decorrelates tracing ledger metrics from the start of a block producer&#x27;s forging loop, thus removing competition on certain synchronization primitives. We&#x27;ve already shown
in past benchmarks it had a positive impact on block production performance. This prototype is now being developed for production release, complete with configuration options, and we aim to land it in Node 10.4.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="node-diversity">Node Diversity<a class="hash-link" href="#node-diversity" title="Direct link to heading">â</a></h3><p>We&#x27;ve contributed to the recent Conformance Testing workshop in Paris. The topic was how to approach detection and documentation of system behaviour across diverse Cardano Node implementations: Where is the behaviour conforming to some blueprint, where
does it deviate - intentionally or accidentally. Our tracing system is the prime provider of observability - and all evidence of program execution could in theory be checked against a machine-readable model of the blueprint. This of course assumes
observables are implemented uniformly across diverse Node projects, i.e. without changing semantics. Thankfully, our tracing system lead engineer JÃ¼rgen Nicklisch was able to join that workshop and add to the discussions around that approach.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/performance-tracing">performance-tracing</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/2025-03-28-performance-and-tracing">Performance &amp; Tracing Update</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2025-03-28T00:00:00.000Z" itemprop="datePublished">March 28, 2025</time> Â· <!-- -->5 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/mgmeier" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/mgmeier.png" alt="Michael Karg"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/mgmeier" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Michael Karg</span></a></div><small class="avatar__subtitle" itemprop="description">Performance and Tracing Team Lead</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="high-level-summary">High level summary<a class="hash-link" href="#high-level-summary" title="Direct link to heading">â</a></h2><ul><li>Benchmarking: Preliminary <code>10.3</code> benchmarks; <code>GHC8</code> / <code>GHC9</code> compiler version comparison; Plutus budget scaling; runtime parameter tuning on <code>GHC9</code>.</li><li>Development: Started new Plutus script calibration tool; maintenance updates to benchmarking profiles.</li><li>Infrastructure: Adjusted tooling to latest Cardano API version; simplification of performance workbench nearing completion.</li><li>New Tracing: Battle-tested metrics monitoring on mainnet; generalized nix service config for <code>cardano-tracer</code>. </li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="low-level-overview">Low level overview<a class="hash-link" href="#low-level-overview" title="Direct link to heading">â</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="benchmarking">Benchmarking<a class="hash-link" href="#benchmarking" title="Direct link to heading">â</a></h3><p>We&#x27;ve run and analyzed several benchmarks these last two weeks:</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="preliminary-103-integration">Preliminary <code>10.3</code> integration<a class="hash-link" href="#preliminary-103-integration" title="Direct link to heading">â</a></h5><p>As performance improvement is a stated goal for the <code>10.3</code> release, we became involved early in the release cycle. Benchmarking the earliest version of the <code>10.3</code> integration branch, we could already
determine that the effort put in has yielded promising results and confirm improvements in both resource usage and block production metrics. A regular release benchmark will be performed, and published, from the final
release tag.  </p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="compiler-versions-ghc965-vs-ghc8107">Compiler versions: <code>GHC9.6.5</code> vs. <code>GHC8.10.7</code><a class="hash-link" href="#compiler-versions-ghc965-vs-ghc8107" title="Direct link to heading">â</a></h5><p>So far, code generation with <code>GHC9.6</code> has resulted in a performance regression for block production under heavy load - we&#x27;ve established that in various past benchmarks. The optimization efforts on <code>10.3</code> also
focused on removing that performance blocker. Benchmarking the integration branch with the newer compiler version has now confirmed it has not only vanished; moreover, code generated with <code>GHC9.6</code>
even exhibited slightly more favourable performance characteristics. So in all likelihood, Node <code>10.3</code> will be the last release to support <code>GHC8.10</code>, and we will recommend <code>GHC9.6</code> as the default build platform for it.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="plutus-budget-scaling">Plutus budget scaling<a class="hash-link" href="#plutus-budget-scaling" title="Direct link to heading">â</a></h5><p>We&#x27;ve repeated several Plutus budget scaling benchmarks on Node version <code>10.3</code> / <code>GHC9.6</code>. By scaling execution budgets to 1.5x and 2x their current mainnet values, we can determine the performance impact on the
network of potential increases of said budgets. We independently measured bumping the steps (CPU) limit with a CPU-intensive script, and bumping the memory limit with a script performing lots of allocations. We could
observe the performance impact to correspond linearly with the limit bump in each case. This gives certainty and predictability of the impact when suggesting changes to mainnet protocol parameters.  </p><p>Our team presented those findings and the data to the Parameter Comittee for discussion.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="runtime-system-rts-settings">Runtime system (RTS) settings<a class="hash-link" href="#runtime-system-rts-settings" title="Direct link to heading">â</a></h5><p>The recommended RTS settings for <code>cardano-node</code> encompass number of CPU cores to use, behaviour of the allocator, and behaviour of the garbage collector. The recommended settings so far are tuned to <code>GHC8.10</code>&#x27;s RTS - one
cannot assume the same settings are optimal for <code>GHC9.6</code>&#x27;s RTS, too. So we&#x27;ve started a series of short, exploratory benchmarks comparing a matrix of promising changes to update our recommendation in the future.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="development">Development<a class="hash-link" href="#development" title="Direct link to heading">â</a></h3><p>We&#x27;ve started to develop a new tool that calibrates our Plutus benchmarking scripts given a range of constraints on the expected workload. These entail exhausting a certain budget (block or transaction), or calibrating
for a constant number of transactions per block while exhausting available steps, or memory, budget(s). The result of that directly serves as input to our benchmarking profile definition. This tool may also be of wider interest, as it
allows for modifying various inputs, such as Plutus cost models, or script serializations generated by different compilers or compiler versions. That way, one can compare at a glance how effective a given script makes
use of the available budgets, given a specific cost model.  </p><p>Additonally, our benchmarking profiles are currently undergoing a maintenance cycle. This means, setups for which motivation has ceased to exist are removed, several are updated to use the Voltaire performance baseline, others
need to be tested for their conformity with the Plomin hard-fork protocol updates.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="infrastructure">Infrastructure<a class="hash-link" href="#infrastructure" title="Direct link to heading">â</a></h3><p>The extensive work of simplifying the performance workbench is almost finished and about to enter testing phase. We have been moving away from scripting to declarative (Haskell) definitions of all benchmark profiles and workloads in
past PRs. The simplification work now reaps the benefits of that: We can optimize away many recursive / redundant invocations or nix evaluations, we can collate many nix store paths into just a couple ones, reduce the workbench&#x27;s
overall closure size and complexity. Apart from saving significant resources and time for CI runners, this will reduce maintence effort necessary on our end.  </p><p>Furthermore, we&#x27;ve done maintenance on our tooling by adjusting to the latest changes in <code>cardano-api</code>. This included porting the <code>ProtocolParameters</code> type and type class instances over to us, as our use case requires
we continue supporting it. However, it&#x27;s considered deprecated in the API, and so this unblocks the team for eventually removing it.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="new-tracing">New Tracing<a class="hash-link" href="#new-tracing" title="Direct link to heading">â</a></h3><p>Having addressed all feature and change requests relevant for the Node 10.3 release, we performed thorough mainnet testing of the new system&#x27;s metrics in a monitoring context. We relied on the extremely diligent and helpful
feedback from the SRE team. This enabled us to iron out a couple of remaining inconsistencies - a big shout-out and thank you to John Lotoski.  </p><p>Additionally, again with SRE, a nix service configuration (SVC) has been created for <code>cardano-tracer</code> that was generalized and aligned in structure with the existing <code>cardano-node</code> SVC. It was evolved from the existing
SVC in our performance workbench, which however was tied tightly to our team&#x27;s use case. With the general approach we hope other teams, and the community, can reliably and easily set up and deploy <code>cardano-tracer</code>.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/performance-tracing">performance-tracing</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/2025-03-11-performance-and-tracing">Performance &amp; Tracing Update</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2025-03-11T00:00:00.000Z" itemprop="datePublished">March 11, 2025</time> Â· <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/mgmeier" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/mgmeier.png" alt="Michael Karg"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/mgmeier" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Michael Karg</span></a></div><small class="avatar__subtitle" itemprop="description">Performance and Tracing Team Lead</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="high-level-summary">High level summary<a class="hash-link" href="#high-level-summary" title="Direct link to heading">â</a></h2><ul><li>Development: New benchmark epoch timeline using <code>db-sync</code>; raw benchmark data now with DB storage layer as default - enabling quick queries.</li><li>Infrastructure: Merged workbench &#x27;playground&#x27; profiles - easing benchmark calibration.</li><li>New Tracing: Plenty new features based on community feedback - including a new direct Prometheus backend; untangle system dependencies.</li><li>Community: Participation in the first episode of the <em>Cardano Dev Pulse</em> podcast.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="low-level-overview">Low level overview<a class="hash-link" href="#low-level-overview" title="Direct link to heading">â</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="development">Development<a class="hash-link" href="#development" title="Direct link to heading">â</a></h3><p>For keeping a history of comparable benchmarks, it&#x27;s essential to have an accurate timeline of mainnet protocol parameter updates by epoch. They represent the environment in which specific measurements took place, and are thus tied
inherently to the observation process. Additionally, to reproduce specific benchmarking metrics from the past, our performance workbench has the capability to &quot;roll back&quot; those updates, and perform a benchmark given the protocol parameters of any given epoch.
Instead of maintaining this epoch timeline by hand, we&#x27;ve now created an automated way to extract all key epochs applying parameter updates using <code>db-sync</code>. This approach will prove both more robust, and having lower maintenance overhead.</p><p>Furthermore, the new DB storage backend for raw benchmarking data in <code>locli</code> is now set to be the default for the performance workbench. Apart from cutting down analysis time for a benchmarking run and reducing
the required on-disk size for archiving, this enables the new (still under development) quick queries into raw performance data.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="infrastructure">Infrastructure<a class="hash-link" href="#infrastructure" title="Direct link to heading">â</a></h3><p>When creating the Plutus memory scaling benchmarks, we developed so-called &#x27;playground&#x27; profiles for the workbench. These allow for easier dynamic change of individual profile parameters, building a resulting benchmark setup including
Plutus script calibration, and observing the effect in a short local cluster run. Applying these changes to established profiles is strictly forbidden, as it would put comparability with past benchmarks at risk. So by
introducing this separation, we keep that safety guarantee, while still lifting it somewhat for the development cycle only.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="new-tracing">New Tracing<a class="hash-link" href="#new-tracing" title="Direct link to heading">â</a></h3><p>We&#x27;ve been extremely busy implementing new features and optimizations for the new tracing system, motivated by the feedback we received from the SPO community. This includes:</p><ul><li>A brand new backend that allows for Prometheus exposition of metrics directly from the application - without running <code>cardano-tracer</code> and forwarding to it.</li><li>A configurable reconnection interval for the forwarder to <code>cardano-tracer</code>.</li><li>An always up-to-date symlink pointing to the most recent log file in a <code>cardano-tracer</code> log rotation.</li><li>Optimizations in metrics forwarding and trace message formatting, which should lower the base CPU usage, at least in low congestion scenarios.</li></ul><p>All those will be part of the upcoming Node 10.3 release.  </p><p>Currently, the <code>cardano-tracer</code> service still depends on the Node for a few data type definitions. We&#x27;re working on a refactoring so we can untangle this dependency. This will allow for the service
to be built independently of the Node - simplifying a setup where other processes and applications can forward observables to <code>cardano-tracer</code> and benefit from its features.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="community">Community<a class="hash-link" href="#community" title="Direct link to heading">â</a></h3><p>We had the opportunity to talk about benchmarking and performance impact of UTxO-HD on the very first episode of the <a href="https://www.youtube.com/@CardanoDevPulse" target="_blank" rel="noopener noreferrer">Cardano Dev Pulse Podcast</a> (YouTube). Thank you Sam and Carlos for having us!</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/performance-tracing">performance-tracing</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/2025-02-21-performance-and-tracing">Performance &amp; Tracing Update</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2025-02-21T00:00:00.000Z" itemprop="datePublished">February 21, 2025</time> Â· <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/mgmeier" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/mgmeier.png" alt="Michael Karg"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/mgmeier" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Michael Karg</span></a></div><small class="avatar__subtitle" itemprop="description">Performance and Tracing Team Lead</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="high-level-summary">High level summary<a class="hash-link" href="#high-level-summary" title="Direct link to heading">â</a></h2><ul><li>Benchmarking: Plutus memory budget scaling benchmarks; UTxO-HD benchmarks, leading to a fixed regression; Genesis benchmarks.</li><li>Development: Ouroboros Genesis and UTxO-HD adjustments in workbench; Maintenance tasks.</li><li>Infrastructure: Removing outdated deployments; Haskell profile definition merged; workbench simplification ongoing.</li><li>Tracing: C library development ongoing; Feature implementation according to community feedback; test removeal of old system.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="low-level-overview">Low level overview<a class="hash-link" href="#low-level-overview" title="Direct link to heading">â</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="benchmarking">Benchmarking<a class="hash-link" href="#benchmarking" title="Direct link to heading">â</a></h3><p>We&#x27;ve run and analyzed scaling benchmarks of Plutus execution budgets. In this series of benchmarks, we measured the performance impact of changes to the memory budgets (both transaction and block). We observed
an expected, and reasonable, increase in certain metrics only. Furthermore, we&#x27;ve shown this increase to be linearly correlated to the budget raise. This means that when exploring the headroom of those budgets,
the performance cost for the network is alawys predictable. The benchmarks serve as a base for discussing potential changes to those budgets in Mainnet protocol parameters.  </p><p>When building a performance baseline for UTxO-HD, we were able to locate a regression in its new in-memory backing store, LedgerDB V2. We created a local reproduction of that for the Consensus team,
who was able to successfully adress the regression. A corresponding benchmarking report will be published on <a href="https://updates.cardano.intersectmbo.org/reports" target="_blank" rel="noopener noreferrer">Cardano Updates</a>.  </p><p>Furthermore, we&#x27;ve performed benchmarks with the Ouroboros Genesis feature enabled and compared them to the release benchmark baseline. We could not detect any performance risk to the network during
&quot;normal operations&quot;, i.e. when all nodes are caught up with the chain tip.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="development">Development<a class="hash-link" href="#development" title="Direct link to heading">â</a></h3><p>During the course of building performance baselines for Ouroboros Genesis and UTxO-HD, we&#x27;ve developed various updates to the performance workbench to correctly handle the new Genesis consensus mode, as well
as adjustments to the latest changes in the UTxO-HD node.  </p><p>Additionally, we built several small quality-of-life improvements for the workbench, as well as investigated and fixed an inconsistent metric (<a href="https://github.com/IntersectMBO/cardano-node/issues/6113" target="_blank" rel="noopener noreferrer">Node Issue #6113</a>).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="infrastructure">Infrastructure<a class="hash-link" href="#infrastructure" title="Direct link to heading">â</a></h3><p>The recent maintenance work also extended to the infrastructure: We&#x27;ve removed the dependency on deprecated environment definitions in <code>iohk-nix</code> by porting the relevant configurations over to the workbench. This
facilitates a thorough cleanup of <code>iohk-nix</code> by the SRE team.  </p><p>As the Haskell package defining benchmarking profiles has been merged, and all code replaced by it successfully removed, we&#x27;re now working very hard on simplifying the interaction between the workbench
and <code>nix</code>. This mostly covers removing redundancies that have lost their motivation, applying to both how workbench calls itself recursively multiple times, as well as how (and how many) corresponding <code>nix</code> store paths
are created when evaluating derivations. This will both enhance maintainability, and result in much lighter workbench builds locally - but especially on CI runners.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tracing">Tracing<a class="hash-link" href="#tracing" title="Direct link to heading">â</a></h3><p>Work on the self-contained C library implementing trace forwarding is ongoing. As forwarding is defined in terms of an <code>OuroborosApplication</code>, it&#x27;s non-trivial to re-implement the feautures of the latter in C as well -
such as handshake, version negotiation, and multiplexing. However, for the intended purpose of said library, it is unavoidable.  </p><p>We&#x27;ve also started working on a new release of <code>cardano-tracer</code>, the trace / metrics consuming service in the new tracing system. This release is geared towards feature or change requests we&#x27;ve received from the community
and found very valuable feedback. Having a seperate service to process all trace output enables us to react much quicker to this feedback, and decouple delivery from the Node&#x27;s release cycle.</p><p>Last not least, we&#x27;re doing an experimental run on creating a build of Node with the legacy tracing system removed. As the system is deeply woven into the code base, and some of the new system&#x27;s components
keep compatibility with the old one, untangling and removing these dependencies is a large endeavour. This build serves as a prototype to identify potential blockers, or decisions to be made, and eventually
as a blueprint for removing the legacy system in some future Node release.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/performance-tracing">performance-tracing</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/2025-02-03-performance-and-tracing">Performance &amp; Tracing Update</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2025-02-03T00:00:00.000Z" itemprop="datePublished">February 3, 2025</time> Â· <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/mgmeier" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/mgmeier.png" alt="Michael Karg"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/mgmeier" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Michael Karg</span></a></div><small class="avatar__subtitle" itemprop="description">Performance and Tracing Team Lead</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="high-level-summary">High level summary<a class="hash-link" href="#high-level-summary" title="Direct link to heading">â</a></h2><ul><li>Benchmarking: Release benchmarks and performance baselines on <code>10.2</code> for UTxO-HD, new GHC, Genesis; &#x27;Perdiodic tracer&#x27; benchmarks.</li><li>Development: Pervasive thread labeling in the Node; fix a race condition in monitoring dependency <code>ekg-wai</code>.</li><li>Infrastructure: Haskell profile definition work passed testing, ready for merge; continued &#x27;Byron&#x27; support in our tooling.</li><li>Tracing: C library for trace forwarding reached prototype stage; last batch of documentation updates ready for publication.</li><li>Community: Support and valuable feedback on Discord for new tracing system rollout.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="low-level-overview">Low level overview<a class="hash-link" href="#low-level-overview" title="Direct link to heading">â</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="benchmarking">Benchmarking<a class="hash-link" href="#benchmarking" title="Direct link to heading">â</a></h3><p>We&#x27;ve performed a full set of release benchmarks and analyses for Node version <code>10.2</code>. We could not detect any performance risks, and expect network performance to be equivalent or slightly better
than <code>10.1.x</code> releases, albeit using slightly more CPU resources under rare conditions.</p><p>Furthermore, we&#x27;re building several performance baselines with <code>10.2</code> to compare future changes, features or node flavours to. For comparative benchmarks, it&#x27;s vital every change be measured individually, as to
be able to discern their individual performance impact. For Node <code>10.3</code>, there are several of those we want to capture, such as crypto class simplifications in Ledger, UTxO-HD with a new in-memory backend,
Ouroboros Genesis, and last not least a new GHC9.6 release addressing a remaining performance blocker when building Cardano.  </p><p>Additionally, we&#x27;ve validated the &#x27;Periodic tracer&#x27; feature on cluster benchmarks and now have evidence of its positive impact on performance. This feature decorrelates gathering metrics from the ledger
from the start of a block producer&#x27;s forging loop, without sacrificing predictability of performance. By removing this competition on certain synchronization primitives, the hot code path in the forging
loop now executes faster. The feature will be integrated in a future version of the Node.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="development">Development<a class="hash-link" href="#development" title="Direct link to heading">â</a></h3><p>We&#x27;ve tracked down a race condition in a community package that both tracing systems depend on for exposing metrics. In <code>ekg-wai</code>, a <code>ThreadKilled</code> exception could be re-thrown to the thread where
it originated from. It is a low-risk condition, as it occurs only when then Node process terminates; however, when terminating due to an error condition, it caused the process to end prematurely, before the
error could be logged. We&#x27;ve opened a <a href="https://github.com/tvh/ekg-wai/pull/12" target="_blank" rel="noopener noreferrer">PR (ekg-wai#12)</a> against the package containing the fix and pre-released on CHaP.    </p><p>Tracking down this condition could have been improved by providing pervasive, human-readable labels for all the threads that the Node process spawns. So in coordination with the Consensus team,
we made sure this is the case for future builds of the Node - including locations in the code where dependency packages internally use <code>forkIO</code> to create green threads. This will
enhance usability of debug output when looking into concurrency issues.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="infrastructure">Infrastructure<a class="hash-link" href="#infrastructure" title="Direct link to heading">â</a></h3><p>The Haskell definition of benchmarking workloads - and the removal of its <code>bash</code>/<code>jq</code> counterpart - is complete, and has passed testing phase. This includes a final alignment between all profile content
defined using either option. Once merged, this will open up the path for simplification of how <code>nix</code> interacts with the performance <code>workbench</code> - and hopefully reduce complexity for our CI runners.  </p><p>As <code>cardano-api</code> is deprecating some protocol parameter related data types which do not have relevance for Cardano anymore, we&#x27;ve had a discussion with stakeholders about the implications for our tooling:
This would effectively disable our ability to benchmark clusters of BFT nodes which do not use a staking / reward-based consensus algorithm - as it used to be in Cardano&#x27;s Byron era. The decision
was made to not drop that ability from our tooling, as there are potential applications for the benchmarks outside of Cardano. As a consequence, we&#x27;ve startied porting those types to live on in our toolchain,
representing an additonal maintenance item within our team.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tracing">Tracing<a class="hash-link" href="#tracing" title="Direct link to heading">â</a></h3><p>The self-contained C library implementing trace forwarding is now in prototype state. It contains a pure C implementation of our forwarding protocol over socket,
as well as pure C CBOR codecs for data payload to match the <code>TraceObject</code> schema used within the context Cardano. That ensures existing tooling can process traces emitted
by non-Cardano applications, written in languages other than Haskell.  </p><p>The latest updates to <a href="https://developers.cardano.org/docs/get-started/cardano-node/new-tracing-system/cardano-tracer" target="_blank" rel="noopener noreferrer">Developer Portal: <code>cardano-tracer</code></a> are ready to be published and awaiting a PR review on the Cardano Developer Portal.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="community">Community<a class="hash-link" href="#community" title="Direct link to heading">â</a></h3><p>We&#x27;ve been quite busy on our new Discord channel <a href="https://discord.com/channels/826816523368005654/1332375957528514590" target="_blank" rel="noopener noreferrer"><em>#tracing-monitoring</em></a> on the <em>IOG&#x27;s Technical Community</em> server. There&#x27;s been
an initial spike of interest and we&#x27;ve been able to provide support and explain various design decisions of the new tracing system. Additionally, we&#x27;ve gotten valuable feedback about potential
features that would greatly help adoption of the new system. These are typically highly localized in their implementation, and non-breaking wrt. to API and design, such that addressing this
feedback promptly adds much value at low risk - Thank You for your input!</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/performance-tracing">performance-tracing</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/tags/performance-tracing"><div class="pagination-nav__label">Newer Entries</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/tags/performance-tracing/page/3"><div class="pagination-nav__label">Older Entries</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/">Home</a></li><li class="footer__item"><a class="footer__link-item" href="/archive">Archive</a></li><li class="footer__item"><a class="footer__link-item" href="/tags">Tags</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 Intersect, Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.a4621276.js"></script>
<script src="/assets/js/main.40817c1a.js"></script>
</body>
</html>