<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-quarterly">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Consensus Q2 2023 Update | Cardano Development Updates</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://updates.cardano.intersectmbo.org/quarterly/2023-Q2-consensus"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Consensus Q2 2023 Update | Cardano Development Updates"><meta data-rh="true" name="description" content="2023-04 -- 2023-06"><meta data-rh="true" property="og:description" content="2023-04 -- 2023-06"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-07-16T17:45:45.000Z"><meta data-rh="true" property="article:author" content="https://github.com/dnadales"><meta data-rh="true" property="article:tag" content="consensus"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://updates.cardano.intersectmbo.org/quarterly/2023-Q2-consensus"><link data-rh="true" rel="alternate" href="https://updates.cardano.intersectmbo.org/quarterly/2023-Q2-consensus" hreflang="en"><link data-rh="true" rel="alternate" href="https://updates.cardano.intersectmbo.org/quarterly/2023-Q2-consensus" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Cardano Updates Feed RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Cardano Updates Feed Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="Cardano Updates Feed JSON Feed">



<link rel="alternate" type="application/rss+xml" href="/quarterly/rss.xml" title="Cardano Development Updates RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/quarterly/atom.xml" title="Cardano Development Updates Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/reports/rss.xml" title="Cardano Development Updates RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/reports/atom.xml" title="Cardano Development Updates Atom Feed">

<script src="https://plausible.io/js/script.js" defer="defer" data-domain="updates.cardano.intersectmbo.org"></script><link rel="stylesheet" href="/assets/css/styles.5c10ca85.css">
<link rel="preload" href="/assets/js/runtime~main.a4621276.js" as="script">
<link rel="preload" href="/assets/js/main.40817c1a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Cardano Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Cardano Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Cardano Updates</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Home</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/quarterly">Quarterly</a><a class="navbar__item navbar__link" href="/reports">Reports</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/tags">Topics</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/tags">All Topics</a></li><li><a class="dropdown__link" href="/tags/network">Network</a></li><li><a class="dropdown__link" href="/tags/consensus">Consensus</a></li><li><a class="dropdown__link" href="/tags/ledger">Ledger</a></li><li><a class="dropdown__link" href="/tags/hydra">Hydra</a></li><li><a class="dropdown__link" href="/tags/db-sync">DB Sync</a></li><li><a class="dropdown__link" href="/tags/cli-api">Node CLI &amp; API</a></li><li><a class="dropdown__link" href="/quarterly/tags/cli-api-quarterly">Node CLI &amp; API Quarterly</a></li><li><a class="dropdown__link" href="/tags/crypto">Crypto</a></li><li><a class="dropdown__link" href="/tags/goedel">Goedel</a></li><li><a class="dropdown__link" href="/tags/mithril">Mithril</a></li><li><a class="dropdown__link" href="/tags/performance-tracing">Performance &amp; Tracing</a></li><li><a class="dropdown__link" href="/reports/tags/benchmarking-reports">Benchmarking Reports</a></li><li><a class="dropdown__link" href="/tags/incident">Incident Reports</a></li><li><a class="dropdown__link" href="/tags/security">Security Reports</a></li></ul></div><a class="navbar__item navbar__link" href="/archive">Archive</a><a href="https://updates.cardano.intersectmbo.org" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/quarterly/2025-Q2-sre">SRE Q2 2025 Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/quarterly/2025-Q1-sre">SRE Q1 2025 Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/quarterly/2024-Q4-sre">SRE Q4 2024 Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/quarterly/2024-Q3-sre">SRE Q3 2024 Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/quarterly/2024-Q2-sre">SRE Q2 2024 Update</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">Consensus Q2 2023 Update</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-07-16T17:45:45.000Z" itemprop="datePublished">July 16, 2023</time> Â· <!-- -->5 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/dnadales" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/dnadales.png" alt="Damian Nadales"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/dnadales" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Damian Nadales</span></a></div><small class="avatar__subtitle" itemprop="description">Consensus Team Lead</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2023-04----2023-06">2023-04 -- 2023-06<a class="hash-link" href="#2023-04----2023-06" title="Direct link to heading">â</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="main-achievements">Main achievements<a class="hash-link" href="#main-achievements" title="Direct link to heading">â</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="utxo-hd">UTxO HD<a class="hash-link" href="#utxo-hd" title="Direct link to heading">â</a></h4><ul><li>We finished a major prototype refactoring, which includes:<ul><li>A better and finer grained DB lock mechanism.</li><li>Elimination of race conditions.</li><li>Support for configuring batch query size and flushing rate. This is crucial to allow node users to tweak performance.</li><li>Architectural simplifications and performance improvements.</li></ul></li><li>We implemented a new package to support db-sync integration with UTxO-HD.</li><li>We ran another set of ad-hoc benchmarks:<ul><li>We uncovered a performance regression on the Network component when using <code>GHC-9.2/9.4</code>.</li><li>The synchronization and replay speed are as expected.</li><li>However, we uncovered memory consumption issues (see figure below).<ul><li>The in-memory backend is consuming more memory than the baseline.</li><li>The LMDB backend shows an unexpected memory usage peak.</li><li>Investigation on these issues is ongoing.</li></ul></li></ul></li><li>We integrated the latest changes in <code>main</code> branch.<ul><li>This required a re-design of the mempool to include the mempool fairness
improvement.</li></ul></li></ul><p><img loading="lazy" src="/assets/images/2023-Q2-utxo-hd-sync-ad-hoc-benchmarks-74f9d76c2602f09652f584cc4d6a0962.png" width="2500" height="1700" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="genesis">Genesis<a class="hash-link" href="#genesis" title="Direct link to heading">â</a></h4><ul><li>The Genesis work for this PI focused on an high-priority issue from the IOG Researchers&#x27; feedback on the proposal.<ul><li>This particular question was not anticipated when the Q2 PI was planned.</li><li>As a result, the chain generators work, the ChainSync Jumping performance work, and the Genesis node prototype work were deprioritized.</li><li>That work has accordingly been rolled over into the Statement of Work for the first Genesis vendor work package.</li></ul></li><li>The IOG Researchers&#x27; feedback on the design was very valuable. It had two primary effects.</li><li>Outcome 1: We re-introduced distinct behaviors when the node is &quot;syncing&quot; versus when it is &quot;caught up&quot;.<ul><li>This eliminated a DoS vector introduced by the proposal, instead of having to argue that it was well-mitigated.</li><li>The additional design complexity is relatively small.</li></ul></li><li>Outcome 2: The issue that was unanticipated is whether the Cardano chain is consistently dense enough to rely on Genesis without any checkpointing.<ul><li>The determination so far is that---assuming the adversary never controls more than four of the seven genesis keys---the most vulnerable segment is in the pure Praos era.</li><li>All the preceding windows are significantly more robust, including the entire Byron and Transitional Praos eras.</li><li>Thus checkpointing is not necessary for the initial Genesis release, though it still may be a reasonable addition later.</li><li>The primary invention was a model for bounding how much benefit the adversary&#x27;s long-range attack could possibly gain from Praos&#x27;s natural short forks.</li></ul></li><li>Relevant questions that the IOG Researchers are still assessing.<ul><li>These do not block the Genesis implementation, but do affect the ultimate values of specific parameters.</li><li>Question 1: what is the upper bound on the duration of an eclipse that a healthy Praos node will survive?</li><li>Question 2: what is the upper bound on how much grinding can improve the adversary&#x27;s leader schedule within some Genesis window?</li></ul></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="support">Support<a class="hash-link" href="#support" title="Direct link to heading">â</a></h4><ul><li>We performed an analysis on number of file descriptors used by Consensus, this
information can be used by the node operators to check if the number of file
descriptors they want to support are enough, thus improving the user (eg node
operator) experience.</li><li>We implemented a mempool fairness improvement, by which transactions are
guaranteed to be processed irrespective of their size.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="technical-debt">Technical debt<a class="hash-link" href="#technical-debt" title="Direct link to heading">â</a></h4><ul><li>We fixed a bug in followers logic, which was discovered by our <code>QuickCheck</code>
property tests.</li><li>We created an <a href="https://github.com/input-output-hk/ouroboros-consensus/pull/68" target="_blank" rel="noopener noreferrer">immutable DB
server</a>. This tool allows to serve blocks from the immutable DB to a node that connects to it. This has a remarkable value for testing and benchmarking purposes. For instance, by using this component, we can benchmark the performance of different aspects of Consensus, such as syncing from scratch, without adding Network interference in the performance results.</li><li>We created a <a href="https://github.com/input-output-hk/ouroboros-consensus/pull/70" target="_blank" rel="noopener noreferrer"><code>db-truncater</code></a> tool, which can be used in disaster recovery and benchmarking scenarios.</li><li>We created a <a href="https://github.com/input-output-hk/ouroboros-consensus/pull/161" target="_blank" rel="noopener noreferrer">benchmarks comparison tool</a> that we plan on using for comparing the performance of two Consensus releases. This will allow us to catch performance regressions early on in the process, before they make it to the node (and show in the system level benchmark tests), thus greatly saving development costs. As an example, the graph below shows the performance <em>improvements</em> introduced by the Ledger team in version <code>0.6.0.0</code> of Consensus wrt version <code>0.5.0.0</code>.</li></ul><p><img loading="lazy" src="/assets/images/2023-Q2-beacon-graph-ded65e814bfe6d927faa1c5c66bbbfad.png" width="1840" height="1372" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="fostering-collaboration">Fostering collaboration<a class="hash-link" href="#fostering-collaboration" title="Direct link to heading">â</a></h4><ul><li>We released <code>fs-sim</code> as open-source repository. This lowers the barrier to entry for external contributors, which will indirectly benefit the Cardano project.</li><li>We migrated the consensus code to a <a href="https://github.com/input-output-hk/ouroboros-consensus" target="_blank" rel="noopener noreferrer">new repository</a>, splitting
it from the <code>ouroboros-network</code> repository. This will save development effort for both the Network and the Consensus teams, since there will be less interference (for instance when making releases).</li><li>We made several improvements to our release processes, which will translate in time savings. As an example, we went from 16 to 4 packages, which makes the release process simpler and smother. Our release process now makes it easier to align versions and make releases (both for us and for our downstream users).</li><li>We added an explanation of the hardfork-combinator forecast horizon, that will benefit not only our team, but future external contributors.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next steps<a class="hash-link" href="#next-steps" title="Direct link to heading">â</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="utxo-hd-1">UTxO HD<a class="hash-link" href="#utxo-hd-1" title="Direct link to heading">â</a></h4><ul><li>We will <a href="https://github.com/input-output-hk/ouroboros-consensus/issues/28" target="_blank" rel="noopener noreferrer">get UTxO-HD ready for handover</a>.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="genesis-1">Genesis<a class="hash-link" href="#genesis-1" title="Direct link to heading">â</a></h4><ul><li>We will regularly liaise with the vendor(s) satisfying the Genesis Statement(s) of Work.</li></ul></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/quarterly/tags/consensus">consensus</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/intersectmbo/cardano-updates/tree/main/quarterly/2023-Q2-consensus.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/quarterly/2023-Q2-network"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Network Q2 2023 Update</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/quarterly/2023-04-25-consensus"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Consensus Quarterly Update</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#2023-04----2023-06" class="table-of-contents__link toc-highlight">2023-04 -- 2023-06</a><ul><li><a href="#main-achievements" class="table-of-contents__link toc-highlight">Main achievements</a></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next steps</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/">Home</a></li><li class="footer__item"><a class="footer__link-item" href="/archive">Archive</a></li><li class="footer__item"><a class="footer__link-item" href="/tags">Tags</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 Intersect, Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.a4621276.js"></script>
<script src="/assets/js/main.40817c1a.js"></script>
</body>
</html>