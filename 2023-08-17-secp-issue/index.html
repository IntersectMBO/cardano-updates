<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-updates">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">SECP bindings Security Issue Report | Cardano Development Updates</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://updates.cardano.intersectmbo.org/2023-08-17-secp-issue"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="SECP bindings Security Issue Report | Cardano Development Updates"><meta data-rh="true" name="description" content="Security Issue Report: SECP256k1 bug"><meta data-rh="true" property="og:description" content="Security Issue Report: SECP256k1 bug"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2023-08-17T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/iquerejeta"><meta data-rh="true" property="article:tag" content="crypto,incident"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://updates.cardano.intersectmbo.org/2023-08-17-secp-issue"><link data-rh="true" rel="alternate" href="https://updates.cardano.intersectmbo.org/2023-08-17-secp-issue" hreflang="en"><link data-rh="true" rel="alternate" href="https://updates.cardano.intersectmbo.org/2023-08-17-secp-issue" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/rss.xml" title="Cardano Updates Feed RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/atom.xml" title="Cardano Updates Feed Atom Feed">
<link rel="alternate" type="application/json" href="/feed.json" title="Cardano Updates Feed JSON Feed">



<link rel="alternate" type="application/rss+xml" href="/quarterly/rss.xml" title="Cardano Development Updates RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/quarterly/atom.xml" title="Cardano Development Updates Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/reports/rss.xml" title="Cardano Development Updates RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/reports/atom.xml" title="Cardano Development Updates Atom Feed">

<script src="https://plausible.io/js/script.js" defer="defer" data-domain="updates.cardano.intersectmbo.org"></script><link rel="stylesheet" href="/assets/css/styles.5c10ca85.css">
<link rel="preload" href="/assets/js/runtime~main.a4621276.js" as="script">
<link rel="preload" href="/assets/js/main.40817c1a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Cardano Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="Cardano Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Cardano Updates</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/">Home</a><a class="navbar__item navbar__link" href="/quarterly">Quarterly</a><a class="navbar__item navbar__link" href="/reports">Reports</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/tags">Topics</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/tags">All Topics</a></li><li><a class="dropdown__link" href="/tags/network">Network</a></li><li><a class="dropdown__link" href="/tags/consensus">Consensus</a></li><li><a class="dropdown__link" href="/tags/ledger">Ledger</a></li><li><a class="dropdown__link" href="/tags/hydra">Hydra</a></li><li><a class="dropdown__link" href="/tags/db-sync">DB Sync</a></li><li><a class="dropdown__link" href="/tags/cli-api">Node CLI &amp; API</a></li><li><a class="dropdown__link" href="/quarterly/tags/cli-api-quarterly">Node CLI &amp; API Quarterly</a></li><li><a class="dropdown__link" href="/tags/crypto">Crypto</a></li><li><a class="dropdown__link" href="/tags/goedel">Goedel</a></li><li><a class="dropdown__link" href="/tags/mithril">Mithril</a></li><li><a class="dropdown__link" href="/tags/performance-tracing">Performance &amp; Tracing</a></li><li><a class="dropdown__link" href="/reports/tags/benchmarking-reports">Benchmarking Reports</a></li><li><a class="dropdown__link" href="/tags/incident">Incident Reports</a></li><li><a class="dropdown__link" href="/tags/security">Security Reports</a></li></ul></div><a class="navbar__item navbar__link" href="/archive">Archive</a><a href="https://updates.cardano.intersectmbo.org" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent Posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-29-consensus">Consensus Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-29-ledger">Ledger Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-29-mithril">Mithril Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-27-performance-and-tracing">Performance &amp; Tracing Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-24-network">Network Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-22-mithril">Mithril Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-17-hydra">Hydra Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-15-mithril">Mithril Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-14-consensus">Consensus Team Update</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/2025-10-10-sre">SRE Team Update</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">SECP bindings Security Issue Report</h1><div class="container_mt6G margin-vert--md"><time datetime="2023-08-17T00:00:00.000Z" itemprop="datePublished">August 17, 2023</time> Â· <!-- -->4 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/iquerejeta" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://github.com/iquerejeta.png" alt="IÃ±igo Querejeta Azurmendi"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/iquerejeta" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">IÃ±igo Querejeta Azurmendi</span></a></div><small class="avatar__subtitle" itemprop="description">Cardano Lead Cryptography Engineer</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="security-issue-report-secp256k1-bug">Security Issue Report: SECP256k1 bug<a class="hash-link" href="#security-issue-report-secp256k1-bug" title="Direct link to heading">â</a></h2><p>Date Occurred: July 15, 2022
Severity:  Potentially Very High if exploited on Mainnet
Authors: IÃ±igo Querejeta Azurmendi</p><p>Date of Report: August 17, 2023</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="summary-of-issue">Summary of Issue<a class="hash-link" href="#summary-of-issue" title="Direct link to heading">â</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="criticality-level">Criticality Level<a class="hash-link" href="#criticality-level" title="Direct link to heading">â</a></h4><p>Actually low (since the issue was detected prior to deployment) but potentially very high if it had been deployed to mainnet
Context</p><p>New SECP256k1 Plutus bindings were being introduced in order to support interoperability with other major chains, such as Bitcoin and Ethereum.  The intention was to deploy these as part of the Vasil hard-fork. The bindings were considered to be a low-security risk since the underlying library functions were well tested and had been deployed on other blockchains.
How was the Issue Detected</p><p>The issue was detected via specific End-to-End tests that had been commissioned.  It was (accidentally) triggered on the Cardano Testnet before a fix could be deployed there.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="what-action-was-taken">What Action was Taken<a class="hash-link" href="#what-action-was-taken" title="Direct link to heading">â</a></h4><p>The Cardano Testnet was permanently halted, and new test environments were deployed (Preview and Pre-Prod).
Fixes were applied to prevent the use of the primitives.
A full security audit was carried out on the bindings.
The rollout of the primitives was postponed to a new hard fork (Valentine)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="potential-effect">Potential Effect<a class="hash-link" href="#potential-effect" title="Direct link to heading">â</a></h4><p>The potential effect was that an adversary might be able to craft invalid Plutus transactions to crash any node, requiring execution of the Cardano disaster recovery plan to revert to a safe state and bypass the transaction.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="actual-effect">Actual Effect<a class="hash-link" href="#actual-effect" title="Direct link to heading">â</a></h4><ul><li>Delay to the Vasil hard-fork</li><li>Temporary removal of SECP256k1 primitives</li><li>Additional hard-fork to introduce SECP256k1 primitives</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ongoing-mitigations-needed-if-any">Ongoing Mitigations Needed, if any<a class="hash-link" href="#ongoing-mitigations-needed-if-any" title="Direct link to heading">â</a></h4><p>None</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="responsibility-for-mitigations">Responsibility for Mitigations<a class="hash-link" href="#responsibility-for-mitigations" title="Direct link to heading">â</a></h4><p>Core team</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="detailed-description-of-incident">Detailed description of Incident<a class="hash-link" href="#detailed-description-of-incident" title="Direct link to heading">â</a></h3><p>New Plutus <strong>secp256k1</strong> cryptographic primitives for Plutus v2 failed to apply the necessary validity checks on the input data, meaning that the primitives could theoretically be used in an unsafe environment.  The vulnerability was present in recent node versions (1.35.0 onwards), including ones deployed to Cardano Testnet.</p><p>The problem was not in the deserialization functions of the underlying library (Bitcoin&#x27;s library) but rather that the Haskell functions that implemented the Plutus builtins were not calling them correctly.  In particular, the library functions were designed to take structured data as input. However, the Haskell FFI implementation that was produced for the Plutus builtins allowed a caller to pass in (possibly) unstructured data. There were no checks that these data were structured in the correct way.  This issue was detected during End-to-End testing.</p><ul><li><a href="https://github.com/bitcoin-core/secp256k1/blob/master/include/secp256k1.h#L518" target="_blank" rel="noopener noreferrer">This</a> is the ECDSA signature verification algorithm that was used. It takes a SECP256k1_pubkey as input. That type is an opaque type with an <a href="https://github.com/bitcoin-core/secp256k1/blob/master/include/secp256k1.h#L61" target="_blank" rel="noopener noreferrer">expected</a> structure: a parsed and valid public key.  It was not immediately obvious that structured data needed to be passed to allow the function to be used safely.</li><li>The same happened with the Schnorr <a href="https://github.com/bitcoin-core/secp256k1/blob/master/include/secp256k1_schnorrsig.h#L170" target="_blank" rel="noopener noreferrer">verification function</a>. It takes as input a SECP256k1_xonly_pubkey, which is again an <a href="https://github.com/bitcoin-core/secp256k1/blob/master/include/secp256k1_extrakeys.h#L10" target="_blank" rel="noopener noreferrer">opaque structure</a> that holds a parsed and valid public key.</li></ul><p>The FFI skipped checks over these structured keys and directly passed the raw bytes that were given as arguments. If an adversary were to pass in data that was not properly structured, then it could result in unexpected behavior of the library. This could perhaps translate into an adversary being able to crash the nodes that ran these functions.  All nodes in the network could be crashed by a single transaction that would then be executed repeatedly, so stalling the network until the disaster recovery process was initiated.</p><p>The fix was addressed in <a href="https://github.com/input-output-hk/cardano-base/pull/289" target="_blank" rel="noopener noreferrer">this</a> PR. It consisted of using the external representation that the deserialization function expects and running the deserialization prior to signature verification.  This was audited by security experts.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="recommendations">Recommendations<a class="hash-link" href="#recommendations" title="Direct link to heading">â</a></h3><ul><li>Check all new Plutus bindings for correct use.</li><li>Audit all new Plutus built-in bindings.</li><li>Continue to develop specific End-to-End tests for all new Plutus features.</li><li>Do not assume that any existing library functions are &quot;safe&quot;. Treat all external calls circumspectly.</li></ul></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/crypto">crypto</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/tags/incident">incident</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/intersectmbo/cardano-updates/tree/main/blog/2023-08-17-secp-security-issue-report.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/2023-08-17-db-sync"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">DB-sync Team Update</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/2023-08-15-node-cli-api"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Node API &amp; CLI Team Update</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#security-issue-report-secp256k1-bug" class="table-of-contents__link toc-highlight">Security Issue Report: SECP256k1 bug</a><ul><li><a href="#summary-of-issue" class="table-of-contents__link toc-highlight">Summary of Issue</a></li><li><a href="#detailed-description-of-incident" class="table-of-contents__link toc-highlight">Detailed description of Incident</a></li><li><a href="#recommendations" class="table-of-contents__link toc-highlight">Recommendations</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Blog</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/">Home</a></li><li class="footer__item"><a class="footer__link-item" href="/archive">Archive</a></li><li class="footer__item"><a class="footer__link-item" href="/tags">Tags</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 Intersect, Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.a4621276.js"></script>
<script src="/assets/js/main.40817c1a.js"></script>
</body>
</html>