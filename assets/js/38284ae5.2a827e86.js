"use strict";(self.webpackChunkcardano_updates=self.webpackChunkcardano_updates||[]).push([[49105],{3905:(e,n,t)=>{t.d(n,{Zo:()=>m,kt:()=>h});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var c=r.createContext({}),s=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},m=function(e){var n=s(e.components);return r.createElement(c.Provider,{value:n},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,c=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),d=s(t),u=a,h=d["".concat(c,".").concat(u)]||d[u]||p[u]||i;return t?r.createElement(h,o(o({ref:n},m),{},{components:t})):r.createElement(h,o({ref:n},m))}));function h(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,o=new Array(i);o[0]=u;var l={};for(var c in n)hasOwnProperty.call(n,c)&&(l[c]=n[c]);l.originalType=e,l[d]="string"==typeof e?e:a,o[1]=l;for(var s=2;s<i;s++)o[s]=t[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},66756:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var r=t(87462),a=(t(67294),t(3905));const i={title:"Performance & Tracing Update",slug:"2023-11-17-performance-and-tracing",authors:"mgmeier",tags:["performance-tracing"],hide_table_of_contents:!1},o=void 0,l={permalink:"/2023-11-17-performance-and-tracing",editUrl:"https://github.com/intersectmbo/cardano-updates/tree/main/blog/2023-11-17-performance-and-tracing.md",source:"@site/blog/2023-11-17-performance-and-tracing.md",title:"Performance & Tracing Update",description:"High level summary",date:"2023-11-17T00:00:00.000Z",formattedDate:"November 17, 2023",tags:[{label:"performance-tracing",permalink:"/tags/performance-tracing"}],readingTime:2.585,hasTruncateMarker:!1,authors:[{name:"Michael Karg",title:"Performance and Tracing Team Lead",url:"https://github.com/mgmeier",imageURL:"https://github.com/mgmeier.png",key:"mgmeier"}],frontMatter:{title:"Performance & Tracing Update",slug:"2023-11-17-performance-and-tracing",authors:"mgmeier",tags:["performance-tracing"],hide_table_of_contents:!1},prevItem:{title:"Hydra Team Update",permalink:"/2023-11-17-hydra"},nextItem:{title:"Network Team Update",permalink:"/2023-11-16-network"}},c={authorsImageUrls:[void 0]},s=[{value:"High level summary",id:"high-level-summary",level:2},{value:"Low level overview",id:"low-level-overview",level:2},{value:"Benchmarking",id:"benchmarking",level:3},{value:"Development",id:"development",level:3},{value:"Tracing",id:"tracing",level:3},{value:"Nomad backend",id:"nomad-backend",level:3},{value:"Workbench",id:"workbench",level:3}],m={toc:s},d="wrapper";function p(e){let{components:n,...t}=e;return(0,a.kt)(d,(0,r.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"high-level-summary"},"High level summary"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Benchmarking: Release benchmarking for node ",(0,a.kt)("inlineCode",{parentName:"li"},"8.6.0")," as well as benchmarks scrutinizing GHC versions and the new tracing system."),(0,a.kt)("li",{parentName:"ul"},"Development: PlutusV3 capability of our workload generator has been implemented."),(0,a.kt)("li",{parentName:"ul"},"Tracing: First round of optimization of the ",(0,a.kt)("inlineCode",{parentName:"li"},"cardano-tracer")," service has completed, awaiting validation."),(0,a.kt)("li",{parentName:"ul"},"Nomad backend: A significant PR has landed addressing automation features and debugging capabilites."),(0,a.kt)("li",{parentName:"ul"},"Workbench: Configurable remote environments and improvements to run documentation have been merged to ",(0,a.kt)("inlineCode",{parentName:"li"},"master"),".")),(0,a.kt)("h2",{id:"low-level-overview"},"Low level overview"),(0,a.kt)("h3",{id:"benchmarking"},"Benchmarking"),(0,a.kt)("p",null,"We've performed and analyzed a full set of benchmarks for node ",(0,a.kt)("inlineCode",{parentName:"p"},"8.6.0"),", both in comparison to recent release tags\nand mainnet version ",(0,a.kt)("inlineCode",{parentName:"p"},"8.1.2"),". A lot of development work has entered the system since then, so it is crucial\nwe can rule out any potential performance risks for the next mainnet release.   "),(0,a.kt)("p",null,"Additionally, we've been benchmarking GHC9.6.3 builds of ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-node"),". Overall, we've observed reliable optimization behaviour by that compiler version - which is much more in line with expectations than what we've seen on GHC9.2.7. Getting evidence on how predictable (and malleable, by code annotations) performance is when building with a certain compiler version is essential for settling on a version as supported release platform. "),(0,a.kt)("p",null,"A last set of benchmarks was dedicated to the new tracing system with node ",(0,a.kt)("inlineCode",{parentName:"p"},"8.6.0"),". We were able to show that\nthere is no performance risk to enabling the new system, even when forwarding all trace messages to a ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-tracer"),"\nservice on the receiving end. Key metrics for block forging, as well as block diffusion, did not exhibit any regression."),(0,a.kt)("h3",{id:"development"},"Development"),(0,a.kt)("p",null,"For future benchmarks to be built around PlutusV3, we've equipped our transaction generator with basic integration and tests for the upcoming Plutus version. This enables us to target the new cost model and potential changes\nto the execution budgets by developing specialized workloads."),(0,a.kt)("h3",{id:"tracing"},"Tracing"),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-tracer")," service has received its first batch of optimizations. Profiling output is promising; to measure\nperformance for a long service run time, we're currently equipping the service binary with the same capability to\nemit regular resource traces as ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-node"),". Analysis of those will be the basis for validating this and possible future optimization efforts."),(0,a.kt)("h3",{id:"nomad-backend"},"Nomad backend"),(0,a.kt)("p",null,"Many improvements for the nomad backend have been implemented and merged to ",(0,a.kt)("inlineCode",{parentName:"p"},"master"),". This encompasses a unified naming schema for all nomad profiles, improved internal management of cluster topology, a more fine-grained healthcheck service,\nmore detailed automated documentation of underlying hardware, as well as lazy resource release. The latter enables\nour team to investigate and debug interrupted runs for the exact moment and in the exact cluster state a potential failure occurred."),(0,a.kt)("h3",{id:"workbench"},"Workbench"),(0,a.kt)("p",null,"Our performance workbench has seen upgrades in documenting and reporting ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-node")," builds. This ranges from capturing package versions and commit ids of key dependencies, to querying a deployed node for its build compiler.\nWhen alternating between compiler versions and benchmarking custom built branches, automating such documentation is essential.  "),(0,a.kt)("p",null,"Furthermore, the workbench is now able to access several remote deployments on all active clusters. This allows for fetching data, analyzing, comparing and reporting on all benchmarks from just one centralized workbench instance."))}p.isMDXComponent=!0}}]);