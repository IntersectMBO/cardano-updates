"use strict";(self.webpackChunkcardano_updates=self.webpackChunkcardano_updates||[]).push([[20553],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),s=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},d=function(e){var t=s(e.components);return r.createElement(c.Provider,{value:t},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,c=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),m=s(n),p=a,h=m["".concat(c,".").concat(p)]||m[p]||u[p]||i;return n?r.createElement(h,o(o({ref:t},d),{},{components:n})):r.createElement(h,o({ref:t},d))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=p;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[m]="string"==typeof e?e:a,o[1]=l;for(var s=2;s<i;s++)o[s]=n[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},7623:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var r=n(87462),a=(n(67294),n(3905));const i={title:"Performance & tracing update",slug:"2023-05-31-performance-and-tracing",authors:"mgmeier",tags:["performance-tracing"],hide_table_of_contents:!1},o=void 0,l={permalink:"/2023-05-31-performance-and-tracing",editUrl:"https://github.com/intersectmbo/cardano-updates/tree/main/blog/2023-05-31-performance-and-tracing.md",source:"@site/blog/2023-05-31-performance-and-tracing.md",title:"Performance & tracing update",description:"High level summary",date:"2023-05-31T00:00:00.000Z",formattedDate:"May 31, 2023",tags:[{label:"performance-tracing",permalink:"/tags/performance-tracing"}],readingTime:2.055,hasTruncateMarker:!1,authors:[{name:"Michael Karg",title:"Performance and Tracing Team Lead",url:"https://github.com/mgmeier",imageURL:"https://github.com/mgmeier.png",key:"mgmeier"}],frontMatter:{title:"Performance & tracing update",slug:"2023-05-31-performance-and-tracing",authors:"mgmeier",tags:["performance-tracing"],hide_table_of_contents:!1},prevItem:{title:"Consensus Team Update",permalink:"/2023-05-31-consensus"},nextItem:{title:"Goedel Team Update",permalink:"/2023-05-26-goedel"}},c={authorsImageUrls:[void 0]},s=[{value:"High level summary",id:"high-level-summary",level:2},{value:"Low level overview",id:"low-level-overview",level:2},{value:"Benchmarking",id:"benchmarking",level:3},{value:"Tracing",id:"tracing",level:3},{value:"Nomad backend",id:"nomad-backend",level:3}],d={toc:s},m="wrapper";function u(e){let{components:t,...n}=e;return(0,a.kt)(m,(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"high-level-summary"},"High level summary"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Benchmarking: We've performed and analysed first benchmarks with GHC9.2 builds. Additionally we have developed an early indicator for how build config changes might reflect on metrics from our model cluster."),(0,a.kt)("li",{parentName:"ul"},"New tracing: Collaboration with Galois led to the new tracing system to be equipped with a re-forwarding mechanism."),(0,a.kt)("li",{parentName:"ul"},"Nomad backend: Porting the 52 node model cluster to nomad cloud is ongoing, with the focus on deployment and health checks.")),(0,a.kt)("h2",{id:"low-level-overview"},"Low level overview"),(0,a.kt)("h3",{id:"benchmarking"},"Benchmarking"),(0,a.kt)("p",null,"The first set of runs with GHC9.2 as a build platform are in. We've discovered a significant difference in resource profile usage compared to GHC8.10. Further investigation uncovered the need for benchmarking another parameter change in the build\nconfiguration: As it stands, the ",(0,a.kt)("inlineCode",{parentName:"p"},"ghc-bignum")," package is using the Haskell ",(0,a.kt)("inlineCode",{parentName:"p"},"native-backend")," as a default. We strive\nto benchmark a build with the ",(0,a.kt)("inlineCode",{parentName:"p"},"gmp-backend")," next.  "),(0,a.kt)("p",null,"A variant of our ",(0,a.kt)("inlineCode",{parentName:"p"},"forge-stress")," local benchmark has been set up to serve as an early indicator for the resource usage profile\nwe'd expect to observe on the model cluster. This provides us with a much tighter feedback loop, as local run duration is way\nshorter. This indicator is specific to changes in the configuration of build and the runtime systems, and will be of great\nsupport when evaluating different compiler versions or RTS flags incrementally."),(0,a.kt)("h3",{id:"tracing"},"Tracing"),(0,a.kt)("p",null,"The hub of the new tracing system ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-tracer")," is designed with a fixed output behaviour, which is limited to various\nlogging options. Thanks to the contribution from Galois, that design is now extended to be able to re-forward all, or a pre-filtered portion, of traces from the node in a configurable manner. This will enable downstream applications to\ndirectly receive the set of trace values relevant to their logic, without any additional cost for the node itself at all."),(0,a.kt)("h3",{id:"nomad-backend"},"Nomad backend"),(0,a.kt)("p",null,"We're currently working out the details of efficiently deploying and monitoring a fleet of 50+ nodes, along with\njob definitions for tracing and transaction generation. Scaling up to those many instances, and monitoring an ongoing\nbenchmarking run required us to fine-tune communications with the nomad server.  "),(0,a.kt)("p",null,"Related to that, the new cloud backend will provide a monitoring and health-checking mechanism which is far more flexible\nand offers more detailed insight than the previous iteration in ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-ops"),". The backend will enable you to formulate\nvery specific conditions for an ongoing run to be considered healthy, and offer automation of certain actions should these conditions not be met."))}u.isMDXComponent=!0}}]);