"use strict";(self.webpackChunkcardano_updates=self.webpackChunkcardano_updates||[]).push([[84991],{3905:(e,t,r)=>{r.d(t,{Zo:()=>p,kt:()=>h});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=n.createContext({}),c=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},p=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=c(r),u=a,h=d["".concat(s,".").concat(u)]||d[u]||m[u]||o;return r?n.createElement(h,i(i({ref:t},p),{},{components:r})):n.createElement(h,i({ref:t},p))}));function h(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:a,i[1]=l;for(var c=2;c<o;c++)i[c]=r[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}u.displayName="MDXCreateElement"},13875:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var n=r(87462),a=(r(67294),r(3905));const o={title:"Performance & Tracing Update",slug:"2025-04-15-performance-and-tracing",authors:"mgmeier",tags:["performance-tracing"],hide_table_of_contents:!1},i=void 0,l={permalink:"/2025-04-15-performance-and-tracing",editUrl:"https://github.com/intersectmbo/cardano-updates/tree/main/blog/2025-04-15-performance-and-tracing.md",source:"@site/blog/2025-04-15-performance-and-tracing.md",title:"Performance & Tracing Update",description:"High level summary",date:"2025-04-15T00:00:00.000Z",formattedDate:"April 15, 2025",tags:[{label:"performance-tracing",permalink:"/tags/performance-tracing"}],readingTime:3.665,hasTruncateMarker:!1,authors:[{name:"Michael Karg",title:"Performance and Tracing Team Lead",url:"https://github.com/mgmeier",imageURL:"https://github.com/mgmeier.png",key:"mgmeier"}],frontMatter:{title:"Performance & Tracing Update",slug:"2025-04-15-performance-and-tracing",authors:"mgmeier",tags:["performance-tracing"],hide_table_of_contents:!1},prevItem:{title:"Network Team Update",permalink:"/2025-04-15-network"},nextItem:{title:"SRE Team Update",permalink:"/2025-04-11-sre"}},s={authorsImageUrls:[void 0]},c=[{value:"High level summary",id:"high-level-summary",level:2},{value:"Low level overview",id:"low-level-overview",level:2},{value:"Benchmarking",id:"benchmarking",level:3},{value:"Development",id:"development",level:3},{value:"Infrastructure",id:"infrastructure",level:3},{value:"New Tracing",id:"new-tracing",level:3},{value:"Node Diversity",id:"node-diversity",level:3}],p={toc:c},d="wrapper";function m(e){let{components:t,...r}=e;return(0,a.kt)(d,(0,n.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"high-level-summary"},"High level summary"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Benchmarking"),": ",(0,a.kt)("inlineCode",{parentName:"li"},"10.3.1")," release benchmarks."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Development"),": Plutus script calibration tool and profile maintenance updates about to be merged."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Infrastructure"),": Workbench simplification about to be merged."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"New Tracing"),": System dependencies untangled; preparing 'Periodic tracer' feature for production."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Node Diversity"),": Participation in Conformance Testing workshop in Paris.")),(0,a.kt)("h2",{id:"low-level-overview"},"Low level overview"),(0,a.kt)("h3",{id:"benchmarking"},"Benchmarking"),(0,a.kt)("p",null,"We're currently running release benchmarks for the upcoming Node ",(0,a.kt)("inlineCode",{parentName:"p"},"10.3.1")," version - a candidate for Mainnet release. Having taken previous measurements on the release integration branch, we expect the results to be closely aligned with these.  "),(0,a.kt)("p",null,"Node ",(0,a.kt)("inlineCode",{parentName:"p"},"10.3.1")," will support two compiler versions, namely GHC8.10.7 and GHC9.6.5. As a consequence, we benchmark both Node builds and compare against the previous performance baseline ",(0,a.kt)("inlineCode",{parentName:"p"},"10.2"),". So far, the release benchmarks confirm\nperformance improvements in both resource usage and block production metrics seen on the integration branch - for both compiler versions. A final report will be published on ",(0,a.kt)("a",{parentName:"p",href:"https://updates.cardano.intersectmbo.org/reports"},"Cardano Updates"),"."),(0,a.kt)("h3",{id:"development"},"Development"),(0,a.kt)("p",null,"The first version of our new tool ",(0,a.kt)("inlineCode",{parentName:"p"},"calibrate-script")," is about to be merged. It is part of the ",(0,a.kt)("inlineCode",{parentName:"p"},"tx-generator")," project, and calibrates Plutus benchmarking scripts according to a range of constraints on the expected workload. The tool\ndocuments the result and all intermediate steps in a developer-friendly way. A CSV report is generated which shows all properties of some calibration at a glance: How much execution budget was given, and how much of each execution budget was used,\nwas memory or CPU steps the limiting factor for the script, how large will the resulting transaction be and what will it cost and more. Apart from greatly speeding up development of Plutus benchmarks for our team, this tool can also be used to assess\nchanges to Plutus cost models, or efficiency of different Plutus compiler outputs - without running a full benchmark.  "),(0,a.kt)("p",null,"Furthermore, the benchmarking profiles defined in ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-profile")," have undergone a large maintenance cycle. Besides a cleanup, several profiles were fixed wrt. transaction fees or duration, others now run on a more appropriate performance baseline.\nThere era-dependency of a profile requiring a minimum protocol version has been solved such that it's now impossible to construct incompatible profiles by definition - e.g. a ",(0,a.kt)("inlineCode",{parentName:"p"},"PlutusV3")," benchmark in any era prior to Conway. The correspondig PR is about to be merged\nshortly."),(0,a.kt)("h3",{id:"infrastructure"},"Infrastructure"),(0,a.kt)("p",null,"A large PR simplifying the build of our performance workbench has been finalized and passed testing. The nix code has been greatly optimized to avoid redundant derivations and creating an abundance of nix store paths. This not only makes the workbench\nbetter maintainable, it greatly reduces time and size requirements for CI jobs. In testing, we could observe a speedup of 40% - 50% for CI. Additionally, this PR prepares for the future removal of GHC8.10 as a release compiler - which will reduce CI\ncost even more. The PR is currently under review and to be merged soon."),(0,a.kt)("h3",{id:"new-tracing"},"New Tracing"),(0,a.kt)("p",null,"The work on untangling dependencies in the new tracing system has entered testing phase. The ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-tracer")," service no longer depends on the Node - with common data types and typeclass instances having been refactored to a more basic package of the\ntracing system. Once merged, this will allow for the service to be built, released and operated independently of ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-node"),", widening its range of use cases.  "),(0,a.kt)("p",null,"On Node 10.1, we've built a prototype of the 'Periodic tracer' feature. It decorrelates tracing ledger metrics from the start of a block producer's forging loop, thus removing competition on certain synchronization primitives. We've already shown\nin past benchmarks it had a positive impact on block production performance. This prototype is now being developed for production release, complete with configuration options, and we aim to land it in Node 10.4."),(0,a.kt)("h3",{id:"node-diversity"},"Node Diversity"),(0,a.kt)("p",null,"We've contributed to the recent Conformance Testing workshop in Paris. The topic was how to approach detection and documentation of system behaviour across diverse Cardano Node implementations: Where is the behaviour conforming to some blueprint, where\ndoes it deviate - intentionally or accidentally. Our tracing system is the prime provider of observability - and all evidence of program execution could in theory be checked against a machine-readable model of the blueprint. This of course assumes\nobservables are implemented uniformly across diverse Node projects, i.e. without changing semantics. Thankfully, our tracing system lead engineer J\xfcrgen Nicklisch was able to join that workshop and add to the discussions around that approach."))}m.isMDXComponent=!0}}]);