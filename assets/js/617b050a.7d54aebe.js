"use strict";(self.webpackChunkcardano_updates=self.webpackChunkcardano_updates||[]).push([[40232],{3905:(e,t,r)=>{r.d(t,{Zo:()=>m,kt:()=>g});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var s=n.createContext({}),c=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},m=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),d=c(r),u=a,g=d["".concat(s,".").concat(u)]||d[u]||p[u]||o;return r?n.createElement(g,i(i({ref:t},m),{},{components:r})):n.createElement(g,i({ref:t},m))}));function g(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[d]="string"==typeof e?e:a,i[1]=l;for(var c=2;c<o;c++)i[c]=r[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}u.displayName="MDXCreateElement"},36781:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var n=r(87462),a=(r(67294),r(3905));const o={title:"Performance & Tracing Update",slug:"2023-12-11-performance-and-tracing",authors:"mgmeier",tags:["performance-tracing"],hide_table_of_contents:!1},i=void 0,l={permalink:"/2023-12-11-performance-and-tracing",editUrl:"https://github.com/intersectmbo/cardano-updates/tree/main/blog/2023-12-11-performance-and-tracing.md",source:"@site/blog/2023-12-11-performance-and-tracing.md",title:"Performance & Tracing Update",description:"High level summary",date:"2023-12-11T00:00:00.000Z",formattedDate:"December 11, 2023",tags:[{label:"performance-tracing",permalink:"/tags/performance-tracing"}],readingTime:3.39,hasTruncateMarker:!1,authors:[{name:"Michael Karg",title:"Performance and Tracing Team Lead",url:"https://github.com/mgmeier",imageURL:"https://github.com/mgmeier.png",key:"mgmeier"}],frontMatter:{title:"Performance & Tracing Update",slug:"2023-12-11-performance-and-tracing",authors:"mgmeier",tags:["performance-tracing"],hide_table_of_contents:!1},prevItem:{title:"Mithril Team Update",permalink:"/2023-12-13-mithril"},nextItem:{title:"Goedel Team Update",permalink:"/2023-12-08-goedel"}},s={authorsImageUrls:[void 0]},c=[{value:"High level summary",id:"high-level-summary",level:2},{value:"Low level overview",id:"low-level-overview",level:2},{value:"Benchmarking",id:"benchmarking",level:3},{value:"Development",id:"development",level:3},{value:"Infrastructure",id:"infrastructure",level:3},{value:"Tracing",id:"tracing",level:3},{value:"Nomad backend",id:"nomad-backend",level:3}],m={toc:c},d="wrapper";function p(e){let{components:t,...r}=e;return(0,a.kt)(d,(0,n.Z)({},m,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"high-level-summary"},"High level summary"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Benchmarking: Release benchmarking for node ",(0,a.kt)("inlineCode",{parentName:"li"},"8.7.2"),", as well as P2P benchmarks - the latter being a premiere for the Nomad cluster."),(0,a.kt)("li",{parentName:"ul"},"Development: Work on automating the submission of Conway transactions for registration of and stake delegation to ",(0,a.kt)("inlineCode",{parentName:"li"},"DRep"),"s is ongoing."),(0,a.kt)("li",{parentName:"ul"},"Infrastructure: We're preparing to safely retire our current benchmarking cluster."),(0,a.kt)("li",{parentName:"ul"},"Tracing: The documentation for the new tracing system is being reworked. Additionally, we've added a feature to ",(0,a.kt)("inlineCode",{parentName:"li"},"cardano-tracer")," to capture performance over a long runtime."),(0,a.kt)("li",{parentName:"ul"},"Nomad cluster: The Nomad backend has been successfully equipped with support for up-to-date P2P topology, as well as deployment for Plutus script data.")),(0,a.kt)("h2",{id:"low-level-overview"},"Low level overview"),(0,a.kt)("h3",{id:"benchmarking"},"Benchmarking"),(0,a.kt)("p",null,"We've performed a full set of release benchmarks for node ",(0,a.kt)("inlineCode",{parentName:"p"},"8.7.2"),". From a performance perspective, it has been greenlit for mainnet release. Starting with this version, our team will publish observations alongside the original comparative analysis of benchmarks, providing insight into key metrics and resource usage. Hence, for the post on version ",(0,a.kt)("inlineCode",{parentName:"p"},"8.7.2"),", see ",(0,a.kt)("a",{parentName:"p",href:"/reports/2023-12-performance-8.7.2"},"here"),"."),(0,a.kt)("p",null,"Additionally, we're running P2P versus no-P2P benchmarks on the same version. We intend to establish future baseline runs using P2P topology as the default setting. All our cluster nodes being block producers, it is crucial to establish the P2P stack does not exhibit any regression regarding block forging. Furthermore, the evidence gathered from those benchmarks forms the base for a recommended setting for P2P on mainnet block producers.  "),(0,a.kt)("p",null,"It deserves special mention that those P2P benchmarks are our first production runs with the Nomad cluster - and using the new tracing system exclusively. Having finalized all optimization rounds of the latter, and having meticulously eliminated all confounding factors from the Nomad infrastructure, we're confident in the measurements being subject to extremely low variance - which we made sure of in many past validation runs on Nomad."),(0,a.kt)("h3",{id:"development"},"Development"),(0,a.kt)("p",null,"Orchestrating ",(0,a.kt)("inlineCode",{parentName:"p"},"DRep")," actions into benchmarking workflows has opened up a fairly large design space. Currently, we're focusing on having stake delegated to ",(0,a.kt)("inlineCode",{parentName:"p"},"DRep"),"s, in order to trigger ledger pulses for calculations particular to ",(0,a.kt)("inlineCode",{parentName:"p"},"DRep")," actions. We can benchmark a possible\nperformance impact of those pulses - even if there are no actions ongoing -  as a first step.  "),(0,a.kt)("p",null,"The contributing factors to the cost of those pulses are both the number of ",(0,a.kt)("inlineCode",{parentName:"p"},"DRep"),"s registered, and the number of delegations to them. It is still under debate which values represent a probable model for mainnet, and whether we can achieve stake delegation programmatically (i.e. by submitting transactions), or if, for large numbers, we need means to inject those delegations into genesis."),(0,a.kt)("h3",{id:"infrastructure"},"Infrastructure"),(0,a.kt)("p",null,"With the switch of all production benchmarks to the Nomad cluster, we will retire the legacy ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-ops")," cluster very shortly. Currently, we're making sure that when all its resources are released, we keep an archive for all runs performed, including all raw log data - with the oldest runs dating back as far as December 2019."),(0,a.kt)("h3",{id:"tracing"},"Tracing"),(0,a.kt)("p",null,"We've outfitted the ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-tracer")," service with the same kind of resource tracing machinery that's used by ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-node")," - as well as created a dedicated benchmarking profile for it. It puts very little pressure on the node; instead it causes 6 nodes to emit traces at a rate of >35 messages per second, putting pressure on ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-tracer")," via trace forwarding at >200 messages per second for an extended period of time. Analysis of these traces will form the ground for various optimizations of ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-tracer")," that are currently being worked on.  "),(0,a.kt)("p",null,"As we aim for early 2024 to be able to recommend the new tracing system as default in production use, we're currently also reworking the comprehensive documentation to reflect all changes made over the last months."),(0,a.kt)("h3",{id:"nomad-backend"},"Nomad backend"),(0,a.kt)("p",null,"In addition to being able to deploy Plutus script data and redeemers seperately (instead of inlining them as the legacy cluster did), the Nomad cluster now supports being set up with recent P2P topology. No-P2P topology format will still be supported\nfor occasional regression benchmarking of the P2P stack, when desired. Furthermore, we've completed porting all benchmarking profiles from the legacy cluster to Nomad."))}p.isMDXComponent=!0}}]);