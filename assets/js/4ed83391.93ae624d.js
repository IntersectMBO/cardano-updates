"use strict";(self.webpackChunkcardano_updates=self.webpackChunkcardano_updates||[]).push([[22838],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>h});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=r.createContext({}),s=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},m=function(e){var t=s(e.components);return r.createElement(c.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,c=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),u=s(n),p=a,h=u["".concat(c,".").concat(p)]||u[p]||d[p]||i;return n?r.createElement(h,o(o({ref:t},m),{},{components:n})):r.createElement(h,o({ref:t},m))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=p;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[u]="string"==typeof e?e:a,o[1]=l;for(var s=2;s<i;s++)o[s]=n[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},50994:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var r=n(87462),a=(n(67294),n(3905));const i={title:"Performance & tracing update",slug:"2023-09-22-performance-and-tracing",authors:"mgmeier",tags:["performance-tracing"],hide_table_of_contents:!1},o=void 0,l={permalink:"/2023-09-22-performance-and-tracing",editUrl:"https://github.com/intersectmbo/cardano-updates/tree/main/blog/2023-09-22-performance-and-tracing.md",source:"@site/blog/2023-09-22-performance-and-tracing.md",title:"Performance & tracing update",description:"High level summary",date:"2023-09-22T00:00:00.000Z",formattedDate:"September 22, 2023",tags:[{label:"performance-tracing",permalink:"/tags/performance-tracing"}],readingTime:2.445,hasTruncateMarker:!1,authors:[{name:"Michael Karg",title:"Performance and Tracing Team Lead",url:"https://github.com/mgmeier",imageURL:"https://github.com/mgmeier.png",key:"mgmeier"}],frontMatter:{title:"Performance & tracing update",slug:"2023-09-22-performance-and-tracing",authors:"mgmeier",tags:["performance-tracing"],hide_table_of_contents:!1},prevItem:{title:"Hydra Team Update",permalink:"/2023-09-22-hydra"},nextItem:{title:"Consensus Team Update",permalink:"/2023-09-20-consensus"}},c={authorsImageUrls:[void 0]},s=[{value:"High level summary",id:"high-level-summary",level:2},{value:"Low level overview",id:"low-level-overview",level:2},{value:"Benchmarking",id:"benchmarking",level:3},{value:"Infrastructure",id:"infrastructure",level:3},{value:"Tracing",id:"tracing",level:3},{value:"Nomad backend",id:"nomad-backend",level:3},{value:"New team member",id:"new-team-member",level:3}],m={toc:s},u="wrapper";function d(e){let{components:t,...n}=e;return(0,a.kt)(u,(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"high-level-summary"},"High level summary"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Benchmarking: We've performed both low-level network and high-level variance analysis of our benchmarking clusters."),(0,a.kt)("li",{parentName:"ul"},"Infrastructure: Our reporting pipeline was adjusted to classify various workloads easily reducing rework time."),(0,a.kt)("li",{parentName:"ul"},"Tracing: Work on machine-readable tracing of tracer configuration is ongoing."),(0,a.kt)("li",{parentName:"ul"},"Nomad backend: We've been able to eliminate several possible confounders on the nomad cluster."),(0,a.kt)("li",{parentName:"ul"},"Team: We're currently onboarding a new team member: Welcome to Cardano Performance & Tracing, Baldur Bl\xf6ndal!")),(0,a.kt)("h2",{id:"low-level-overview"},"Low level overview"),(0,a.kt)("h3",{id:"benchmarking"},"Benchmarking"),(0,a.kt)("p",null,"As part of the effort to bring the Nomad backend into production use, we've been equipping both that and the existing benchmarking\nbackend with means to measure and document network latency for each run. Furthermore we've implemented means to\ncapture TCP packets for a limited time window during a benchmarking run - which will allow us to spot differences\nin the behaviour of the underlying networking stack at OS level.  "),(0,a.kt)("p",null,"Additionally, we're running variance analysis in parallel on both backends to ascertain confidence in metrics originating from either. We've concluded that baseline profile runs aren't directly comparable between the two, so we decided\nto compare standard deviations instead to validate the measurements from nomad."),(0,a.kt)("h3",{id:"infrastructure"},"Infrastructure"),(0,a.kt)("p",null,"Reporting on benchmarks does require human time and effort to rework the final document. Improvements to the reporting pipeline\nhave been merged to ",(0,a.kt)("inlineCode",{parentName:"p"},"master"),". They reduce the time necessary to do so by various changes to the template and the workload classification logic in analysis.  "),(0,a.kt)("p",null,"Beyond that, we've looked into issues where services would quit with an unjustified exit failure upon shutdown - under rare circumstances. By reworking shutdown logic for ",(0,a.kt)("inlineCode",{parentName:"p"},"trace-dispatcher")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"tx-generator")," we were able to address those issues."),(0,a.kt)("h3",{id:"tracing"},"Tracing"),(0,a.kt)("p",null,"After various steps in constructing a configuration upon node startup, it is vital to document\nwhich runtime configuration the node arrived eventually. We're working on providing a machine-readable JSON/YAML\ntrace message for that purpose.  "),(0,a.kt)("p",null,"This will facilitate hot-reloading a node's tracer configuration in the future: users will be able to take such a trace message, apply their intended change and hot-reload it immediately into the node. "),(0,a.kt)("h3",{id:"nomad-backend"},"Nomad backend"),(0,a.kt)("p",null,"As with the existing benchmarking cluster, nomad is currently under scrutiny with regard to the reliability of metrics it\nproduces, as well as the behaviour of its OS-level network stack. For instance, differing kernel versions can have an\nimpact on our measurements, as we'd be basically using two different instruments to take them.  "),(0,a.kt)("p",null,"Along the way we've already been successful in eliminating some possible confounders that had been introduced by the nomad service\nor the slightly different system architecture of the new cluster."),(0,a.kt)("h3",{id:"new-team-member"},"New team member"),(0,a.kt)("p",null,"Baldur Bl\xf6ndal is an extremely capable and experienced Haskell developer. Also, he's an excellent fit for our existing team.\nSo I'm very pleased to welcome him onboard with IOG, and with Performance & Tracing. He will be working on ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-tracer"),", the component receiving, processing and making available node traces and metrics."))}d.isMDXComponent=!0}}]);