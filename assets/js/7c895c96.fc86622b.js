"use strict";(self.webpackChunkcardano_updates=self.webpackChunkcardano_updates||[]).push([[83036],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>d});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),u=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=u(e.components);return r.createElement(l.Provider,{value:t},e.children)},c="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),c=u(n),m=a,d=c["".concat(l,".").concat(m)]||c[m]||h[m]||s;return n?r.createElement(d,o(o({ref:t},p),{},{components:n})):r.createElement(d,o({ref:t},p))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,o=new Array(s);o[0]=m;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[c]="string"==typeof e?e:a,o[1]=i;for(var u=2;u<s;u++)o[u]=n[u];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},93424:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>u});var r=n(87462),a=(n(67294),n(3905));const s={title:"Consensus Team Update",slug:"2023-09-06-consensus",authors:"dnadales",tags:["consensus"],hide_table_of_contents:!1},o=void 0,i={permalink:"/2023-09-06-consensus",editUrl:"https://github.com/intersectmbo/cardano-updates/tree/main/blog/2023-09-06-consensus.md",source:"@site/blog/2023-09-06-consensus.md",title:"Consensus Team Update",description:"High level summary",date:"2023-09-06T00:00:00.000Z",formattedDate:"September 6, 2023",tags:[{label:"consensus",permalink:"/tags/consensus"}],readingTime:2.22,hasTruncateMarker:!1,authors:[{name:"Damian Nadales",title:"Consensus Team Lead",url:"https://github.com/dnadales",imageURL:"https://github.com/dnadales.png",key:"dnadales"}],frontMatter:{title:"Consensus Team Update",slug:"2023-09-06-consensus",authors:"dnadales",tags:["consensus"],hide_table_of_contents:!1},prevItem:{title:"Performance & tracing update",permalink:"/2023-09-07-performance-and-tracing"},nextItem:{title:"Goedel Team Update",permalink:"/2023-09-01-goedel"}},l={authorsImageUrls:[void 0]},u=[{value:"High level summary",id:"high-level-summary",level:2},{value:"UTxO-HD",id:"utxo-hd",level:2},{value:"Tech debt",id:"tech-debt",level:2},{value:"Support",id:"support",level:2}],p={toc:u},c="wrapper";function h(e){let{components:t,...n}=e;return(0,a.kt)(c,(0,r.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"high-level-summary"},"High level summary"),(0,a.kt)("p",null,"We were able to successfully run the system-level benchmarks for the UTxO-HD implementation, for the first time. There was an important regression in block forging performance that will have to be addressed before UTxO-HD is released. We also revisited the implementation of our query processing logic, which was needed to address the performance regression found in the query-by-address command. The preliminary performance results show that now the performance of this query is on-par with the Cardano baseline version, but we need further confirmation.\nOn the Genesis front, we presented the grinding-aware safety argument for the proposed historical Cardano Genesis windows to the IOG Researchers.\nThe Consensus release engineer finished his rotation: version ",(0,a.kt)("inlineCode",{parentName:"p"},"8.3.0-pre")," of ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-node")," is releasing 2023 September 5."),(0,a.kt)("h2",{id:"utxo-hd"},"UTxO-HD"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"We ran the first successful system-level benchmarks for UTxO-HD (see ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/input-output-hk/ouroboros-consensus/issues/203"},"#203"),") using the ",(0,a.kt)("em",{parentName:"li"},"in-memory")," backend.",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"We observed a factor 12 regression in the forging performance, which we will have to address. There are strong indications that the regression is due to the backing store accesses that take place when taking a mempool snapshot."),(0,a.kt)("li",{parentName:"ul"},"After the mempool regression is fixed the benchmarks need to be ran again."),(0,a.kt)("li",{parentName:"ul"},"System-level UTxO-HD benchmarks with the LMDB are still pending."))),(0,a.kt)("li",{parentName:"ul"},"UTxO-HD will eventually be necessary due to the growth of the UTxO set and other ledger state structures that live in memory at the moment. However, we are trying a strategy by which we could preserve the baseline performance of the node, in case SPOs and other node users are not ready to migrate yet (see ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/input-output-hk/ouroboros-consensus/issues/344"},"#344"),")."),(0,a.kt)("li",{parentName:"ul"},"We implemented a new way of processing queries at the hard-fork block level, which resolves the performance regression observed in ",(0,a.kt)("inlineCode",{parentName:"li"},"GetUTxOByAddress")," (see ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/input-output-hk/ouroboros-consensus/issues/205#issuecomment-1706878418"},"this comment"),"). Preliminary results are promising."),(0,a.kt)("li",{parentName:"ul"},"Regarding the roll out plan, UTxO-HD requires a significant change in the Consensus codebase. Even though we might be able to hide any potential performance impact in the node by keeping all data in memory (",(0,a.kt)("a",{parentName:"li",href:"https://github.com/input-output-hk/ouroboros-consensus/issues/344"},"#344"),"), the Consensus component was significantly changed, so we might have to postpone releasing this feature to mitigate any risks of conflicting with the implementation of CIP-1694 and release of Conway.")),(0,a.kt)("h2",{id:"tech-debt"},"Tech debt"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"We added tests that Consensus emits valid CBOR (",(0,a.kt)("a",{parentName:"li",href:"https://github.com/input-output-hk/ouroboros-network/issues/3099"},"#3099"),"). This helped us detect a couple of serialization bugs. The tests still need to be merged into the ",(0,a.kt)("inlineCode",{parentName:"li"},"main")," branch (",(0,a.kt)("a",{parentName:"li",href:"https://github.com/input-output-hk/ouroboros-consensus/pull/323"},"#323"),").")),(0,a.kt)("h2",{id:"support"},"Support"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/nfrisby"},"Nick Frisby")," finished his release engineer rotation; ",(0,a.kt)("inlineCode",{parentName:"li"},"cardano-node 8.3.0-pre")," is releasing 2023 September 5."),(0,a.kt)("li",{parentName:"ul"},"We helped to investigate a protocol version bug in Sanchonet (see ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/input-output-hk/cardano-ledger/issues/3491"},"#3491"),")."),(0,a.kt)("li",{parentName:"ul"},"We started to implement the Network interface for bootstrap peer functionality, from which Genesis will benefit as well (see ",(0,a.kt)("a",{parentName:"li",href:"https://github.com/input-output-hk/ouroboros-consensus/issues/91"},"#91"),".")))}h.isMDXComponent=!0}}]);