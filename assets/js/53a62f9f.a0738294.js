"use strict";(self.webpackChunkcardano_updates=self.webpackChunkcardano_updates||[]).push([[60551],{3905:(e,t,r)=>{r.d(t,{Zo:()=>m,kt:()=>g});var n=r(67294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var s=n.createContext({}),c=function(e){var t=n.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},m=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),p=c(r),d=o,g=p["".concat(s,".").concat(d)]||p[d]||u[d]||a;return r?n.createElement(g,i(i({ref:t},m),{},{components:r})):n.createElement(g,i({ref:t},m))}));function g(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=r.length,i=new Array(a);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:o,i[1]=l;for(var c=2;c<a;c++)i[c]=r[c];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},71035:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>c});var n=r(87462),o=(r(67294),r(3905));const a={title:"Memory Budget Scaling -- 10.3",slug:"2025-05-execbudget-memory-10.3",authors:"mgmeier",tags:["benchmarking-reports"],hide_table_of_contents:!1},i=void 0,l={permalink:"/reports/2025-05-execbudget-memory-10.3",editUrl:"https://github.com/intersectmbo/cardano-updates/tree/main/reports/2025-05-execbudget-memory-10.3.md",source:"@site/reports/2025-05-execbudget-memory-10.3.md",title:"Memory Budget Scaling -- 10.3",description:"Setup",date:"2025-04-01T09:50:10.000Z",formattedDate:"April 1, 2025",tags:[{label:"benchmarking-reports",permalink:"/reports/tags/benchmarking-reports"}],readingTime:3.58,hasTruncateMarker:!1,authors:[{name:"Michael Karg",title:"Performance and Tracing Team Lead",url:"https://github.com/mgmeier",imageURL:"https://github.com/mgmeier.png",key:"mgmeier"}],frontMatter:{title:"Memory Budget Scaling -- 10.3",slug:"2025-05-execbudget-memory-10.3",authors:"mgmeier",tags:["benchmarking-reports"],hide_table_of_contents:!1},prevItem:{title:"Memory Budget Scaling -- 10.2",permalink:"/reports/2025-03-execbudget-memory-10.2"},nextItem:{title:"Benchmarking -- UTxO-HD on 10.2",permalink:"/reports/2025-02-performance-utxohd-10.2"}},s={authorsImageUrls:[void 0]},c=[{value:"Setup",id:"setup",level:2},{value:"Observations",id:"observations",level:2},{value:"Resource Usage",id:"resource-usage",level:3},{value:"Forging Loop",id:"forging-loop",level:3},{value:"Peer propagation",id:"peer-propagation",level:3},{value:"End-to-end propagation",id:"end-to-end-propagation",level:3},{value:"Conclusion",id:"conclusion",level:3},{value:"Attachment",id:"attachment",level:2}],m={toc:c},p="wrapper";function u(e){let{components:t,...a}=e;return(0,o.kt)(p,(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"setup"},"Setup"),(0,o.kt)("p",null,"This report compares benchmarking runs for 3 different settings of the Plutus memory execution budget:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"10.3-ghc965")," - current mainnet memory execution budget"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"loop-memx1.5")," - 1.5 x current mainnet memory execution budget"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"loop-memx2")," - 2 x current mainnet memory execution budget")),(0,o.kt)("p",null,"For this comparison, we gather various metrics under the ",(0,o.kt)("em",{parentName:"p"},"Plutus")," workload used in release benchmarks: Each block produced during the benchmark contains\n4 identical script transactions calibrated to fully exhaust the memory execution budget. Thus, script execution is constrained by the memory budget limit\nevery case. The workload produces small blocks (< 3kB) exclusively. "),(0,o.kt)("p",null,"Benchmarking is performed on a cluster of 52 block producing nodes spread across 3 different AWS regions, interconnected using a static, restricted topology. Node\nversion 10.3 was used, built with GHC9.6.5. This is a re-run of the scaling benchmarks performed on Node version 10.2 / GHC8.10 to document impact of performance improvements. Those results\nwere published here on ",(0,o.kt)("a",{parentName:"p",href:"https://updates.cardano.intersectmbo.org/reports/2025-03-execbudget-memory-10.2"},"Cardano Updates"),"."),(0,o.kt)("h2",{id:"observations"},"Observations"),(0,o.kt)("h3",{id:"resource-usage"},"Resource Usage"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Scaling the memory budget impacts Allocation Rate and Minor GCs. 1.5 x the budget results in rises of 5% each; for doubling the budget the corresponding rises are 8% and 9%."),(0,o.kt)("li",{parentName:"ol"},"Those increases seem to correlate linearly with raising mem budget."),(0,o.kt)("li",{parentName:"ol"},"The effects on CPU usage and RAM footprint are negligible for both scaling factors.")),(0,o.kt)("p",null,"Caveat: Individual metrics can't be evaluated in isolate; the resource usage profile as a whole provides insight into the system's performance and responsiveness."),(0,o.kt)("h3",{id:"forging-loop"},"Forging Loop"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Scaling the memory budget has significant impact on block adoption time only."),(0,o.kt)("li",{parentName:"ol"},"Scaling by factor 1.5 leads to a 10ms (or 24%) increase, whereas factor 2 leads to 21ms (50%).")),(0,o.kt)("h3",{id:"peer-propagation"},"Peer propagation"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Same as on the block producer, scaling the memory budget has significant impact on block adoption times only."),(0,o.kt)("li",{parentName:"ol"},"Scaling by factor 1.5 leads to a 11ms (or 24%) increase, whereas factor 2 leads to 19ms (42%).")),(0,o.kt)("h3",{id:"end-to-end-propagation"},"End-to-end propagation"),(0,o.kt)("p",null,"This metric encompasses block diffusion and adoption across specific percentages of the benchmarking cluster, with 0.80 adoption meaning adoption on 80% of all cluster nodes.  "),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"1.5 x the memory budget results in a slight increase of  9ms - 31ms in cluster adoption times (3% - 6%)."),(0,o.kt)("li",{parentName:"ol"},"2 x the memory budget results in a moderate 17ms - 35ms increase (5% - 7%).")),(0,o.kt)("h3",{id:"conclusion"},"Conclusion"),(0,o.kt)("p",null,"These measurements outline the headroom for raising the memory budget, along with the expected performance impact:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Block adoption time is the only metric that's affected significantly, increasing both on the forger and the peers by the same extent."),(0,o.kt)("li",{parentName:"ol"},"These increases seem to correspond linearly with the raising the memory budget. This gives excellent predictability of performance impact."),(0,o.kt)("li",{parentName:"ol"},"Expectedly, more allocations happen; we can observe the same linear correspondence here as well."),(0,o.kt)("li",{parentName:"ol"},"It has to be pointed out that block diffusion is only slightly affected by changing the execution budget: Due to pipelining, announcing and (re-)sending a block precedes adoption in most cases."),(0,o.kt)("li",{parentName:"ol"},"As such, regarding absolute cluster adoption times, measurements taken with either budget adjustment do not exhibit performance risks to the network. They do illustrate, however, the performance cost of those budget adjustments.")),(0,o.kt)("p",null,"These scaling benchmarks are complementary to those performed on Node 10.2; in comparison with those, we can additionally conclude:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"The conclusions from measurements for each scaling run set are identical."),(0,o.kt)("li",{parentName:"ol"},"While the relative increases in adoption time for both Node builds are quite similar, the absolute increases are 22% - 32% ",(0,o.kt)("em",{parentName:"li"},"smaller")," (i.e., adoption happens more efficiently) for 10.3 / GHC9.6."),(0,o.kt)("li",{parentName:"ol"},"The same rationale applies to end-to-end propagation metrics: Absolute values document faster cluster adoption for 10.3 / GHC9.6. "),(0,o.kt)("li",{parentName:"ol"},"Incidentally, the absolute values for scaling factor 1 on 10.2 are close to those for scaling factor 2 on 10.3 except for the tail end (i.e. 95th percentile and above)."),(0,o.kt)("li",{parentName:"ol"},"This reflects the performance improvements that were a stated goal for the 10.3 release - and suggests the performance cost of memory budget increases has become slightly ",(0,o.kt)("em",{parentName:"li"},"smaller")," in absolute terms.")),(0,o.kt)("p",null,"As adoption times are not only impacted by Plutus execution alone, we still advocate for a conservative and/or multi-stage raise; future backpedaling on budget limits could cause issues for scripts already deployed."),(0,o.kt)("h2",{id:"attachment"},"Attachment"),(0,o.kt)("p",null,"Full report PDF downloadable ",(0,o.kt)("a",{target:"_blank",href:r(24760).Z},"here"),"."))}u.isMDXComponent=!0},24760:(e,t,r)=>{r.d(t,{Z:()=>n});const n=r.p+"assets/files/execbudget-10.3-mem_scaling-af25748ab9933bb24a20c245b885dc7e.pdf"}}]);