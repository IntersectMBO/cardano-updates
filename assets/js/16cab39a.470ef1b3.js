"use strict";(self.webpackChunkcardano_updates=self.webpackChunkcardano_updates||[]).push([[28678],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>h});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},m=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),d=c(n),p=a,h=d["".concat(l,".").concat(p)]||d[p]||u[p]||o;return n?r.createElement(h,i(i({ref:t},m),{},{components:n})):r.createElement(h,i({ref:t},m))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[d]="string"==typeof e?e:a,i[1]=s;for(var c=2;c<o;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},22841:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>c});var r=n(87462),a=(n(67294),n(3905));const o={title:"Performance & Tracing Update",slug:"2025-02-21-performance-and-tracing",authors:"mgmeier",tags:["performance-tracing"],hide_table_of_contents:!1},i=void 0,s={permalink:"/2025-02-21-performance-and-tracing",editUrl:"https://github.com/intersectmbo/cardano-updates/tree/main/blog/2025-02-21-performance-and-tracing.md",source:"@site/blog/2025-02-21-performance-and-tracing.md",title:"Performance & Tracing Update",description:"High level summary",date:"2025-02-21T00:00:00.000Z",formattedDate:"February 21, 2025",tags:[{label:"performance-tracing",permalink:"/tags/performance-tracing"}],readingTime:3.25,hasTruncateMarker:!1,authors:[{name:"Michael Karg",title:"Performance and Tracing Team Lead",url:"https://github.com/mgmeier",imageURL:"https://github.com/mgmeier.png",key:"mgmeier"}],frontMatter:{title:"Performance & Tracing Update",slug:"2025-02-21-performance-and-tracing",authors:"mgmeier",tags:["performance-tracing"],hide_table_of_contents:!1},prevItem:{title:"Mithril Team Update",permalink:"/2025-02-26-mithril"},nextItem:{title:"Consensus Team Update",permalink:"/2025-02-19-consensus"}},l={authorsImageUrls:[void 0]},c=[{value:"High level summary",id:"high-level-summary",level:2},{value:"Low level overview",id:"low-level-overview",level:2},{value:"Benchmarking",id:"benchmarking",level:3},{value:"Development",id:"development",level:3},{value:"Infrastructure",id:"infrastructure",level:3},{value:"Tracing",id:"tracing",level:3}],m={toc:c},d="wrapper";function u(e){let{components:t,...n}=e;return(0,a.kt)(d,(0,r.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"high-level-summary"},"High level summary"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Benchmarking: Plutus memory budget scaling benchmarks; UTxO-HD benchmarks, leading to a fixed regression; Genesis benchmarks."),(0,a.kt)("li",{parentName:"ul"},"Development: Ouroboros Genesis and UTxO-HD adjustments in workbench; Maintenance tasks."),(0,a.kt)("li",{parentName:"ul"},"Infrastructure: Removing outdated deployments; Haskell profile definition merged; workbench simplification ongoing."),(0,a.kt)("li",{parentName:"ul"},"Tracing: C library development ongoing; Feature implementation according to community feedback; test removeal of old system.")),(0,a.kt)("h2",{id:"low-level-overview"},"Low level overview"),(0,a.kt)("h3",{id:"benchmarking"},"Benchmarking"),(0,a.kt)("p",null,"We've run and analyzed scaling benchmarks of Plutus execution budgets. In this series of benchmarks, we measured the performance impact of changes to the memory budgets (both transaction and block). We observed\nan expected, and reasonable, increase in certain metrics only. Furthermore, we've shown this increase to be linearly correlated to the budget raise. This means that when exploring the headroom of those budgets,\nthe performance cost for the network is alawys predictable. The benchmarks serve as a base for discussing potential changes to those budgets in Mainnet protocol parameters.  "),(0,a.kt)("p",null,"When building a performance baseline for UTxO-HD, we were able to locate a regression in its new in-memory backing store, LedgerDB V2. We created a local reproduction of that for the Consensus team,\nwho was able to successfully adress the regression. A corresponding benchmarking report will be published on ",(0,a.kt)("a",{parentName:"p",href:"https://updates.cardano.intersectmbo.org/reports"},"Cardano Updates"),".  "),(0,a.kt)("p",null,'Furthermore, we\'ve performed benchmarks with the Ouroboros Genesis feature enabled and compared them to the release benchmark baseline. We could not detect any performance risk to the network during\n"normal operations", i.e. when all nodes are caught up with the chain tip.'),(0,a.kt)("h3",{id:"development"},"Development"),(0,a.kt)("p",null,"During the course of building performance baselines for Ouroboros Genesis and UTxO-HD, we've developed various updates to the performance workbench to correctly handle the new Genesis consensus mode, as well\nas adjustments to the latest changes in the UTxO-HD node.  "),(0,a.kt)("p",null,"Additionally, we built several small quality-of-life improvements for the workbench, as well as investigated and fixed an inconsistent metric (",(0,a.kt)("a",{parentName:"p",href:"https://github.com/IntersectMBO/cardano-node/issues/6113"},"Node Issue #6113"),")."),(0,a.kt)("h3",{id:"infrastructure"},"Infrastructure"),(0,a.kt)("p",null,"The recent maintenance work also extended to the infrastructure: We've removed the dependency on deprecated environment definitions in ",(0,a.kt)("inlineCode",{parentName:"p"},"iohk-nix")," by porting the relevant configurations over to the workbench. This\nfacilitates a thorough cleanup of ",(0,a.kt)("inlineCode",{parentName:"p"},"iohk-nix")," by the SRE team.  "),(0,a.kt)("p",null,"As the Haskell package defining benchmarking profiles has been merged, and all code replaced by it successfully removed, we're now working very hard on simplifying the interaction between the workbench\nand ",(0,a.kt)("inlineCode",{parentName:"p"},"nix"),". This mostly covers removing redundancies that have lost their motivation, applying to both how workbench calls itself recursively multiple times, as well as how (and how many) corresponding ",(0,a.kt)("inlineCode",{parentName:"p"},"nix")," store paths\nare created when evaluating derivations. This will both enhance maintainability, and result in much lighter workbench builds locally - but especially on CI runners."),(0,a.kt)("h3",{id:"tracing"},"Tracing"),(0,a.kt)("p",null,"Work on the self-contained C library implementing trace forwarding is ongoing. As forwarding is defined in terms of an ",(0,a.kt)("inlineCode",{parentName:"p"},"OuroborosApplication"),", it's non-trivial to re-implement the feautures of the latter in C as well -\nsuch as handshake, version negotiation, and multiplexing. However, for the intended purpose of said library, it is unavoidable.  "),(0,a.kt)("p",null,"We've also started working on a new release of ",(0,a.kt)("inlineCode",{parentName:"p"},"cardano-tracer"),", the trace / metrics consuming service in the new tracing system. This release is geared towards feature or change requests we've received from the community\nand found very valuable feedback. Having a seperate service to process all trace output enables us to react much quicker to this feedback, and decouple delivery from the Node's release cycle."),(0,a.kt)("p",null,"Last not least, we're doing an experimental run on creating a build of Node with the legacy tracing system removed. As the system is deeply woven into the code base, and some of the new system's components\nkeep compatibility with the old one, untangling and removing these dependencies is a large endeavour. This build serves as a prototype to identify potential blockers, or decisions to be made, and eventually\nas a blueprint for removing the legacy system in some future Node release."))}u.isMDXComponent=!0}}]);