"use strict";(self.webpackChunkcardano_updates=self.webpackChunkcardano_updates||[]).push([[21031],{3905:(e,t,a)=>{a.d(t,{Zo:()=>s,kt:()=>k});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),d=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},s=function(e){var t=d(e.components);return n.createElement(p.Provider,{value:t},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),m=d(a),c=r,k=m["".concat(p,".").concat(c)]||m[c]||u[c]||i;return a?n.createElement(k,o(o({ref:t},s),{},{components:a})):n.createElement(k,o({ref:t},s))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=c;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[m]="string"==typeof e?e:r,o[1]=l;for(var d=2;d<i;d++)o[d]=a[d];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},62898:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var n=a(87462),r=(a(67294),a(3905));const i={title:"SRE Team Update",slug:"2024-08-09-sre",authors:"manveru",tags:["sre"],hide_table_of_contents:!1},o=void 0,l={permalink:"/2024-08-09-sre",editUrl:"https://github.com/intersectmbo/cardano-updates/tree/main/blog/2024-08-09-sre.md",source:"@site/blog/2024-08-09-sre.md",title:"SRE Team Update",description:"High level summary",date:"2024-08-09T00:00:00.000Z",formattedDate:"August 9, 2024",tags:[{label:"sre",permalink:"/tags/sre"}],readingTime:4.63,hasTruncateMarker:!1,authors:[{name:"Michael Fellinger",title:"SRE Team Lead",url:"https://github.com/manveru",imageURL:"https://github.com/manveru.png",key:"manveru"}],frontMatter:{title:"SRE Team Update",slug:"2024-08-09-sre",authors:"manveru",tags:["sre"],hide_table_of_contents:!1},prevItem:{title:"Ledger Team Update",permalink:"/2024-08-14-ledger"},nextItem:{title:"Consensus Team Update",permalink:"/2024-08-07-consensus"}},p={authorsImageUrls:[void 0]},d=[{value:"High level summary",id:"high-level-summary",level:2},{value:"Repository Work",id:"repository-work",level:2},{value:"Cardano Airgap",id:"cardano-airgap",level:3},{value:"Cardano Parts",id:"cardano-parts",level:3},{value:"Overview",id:"overview",level:4},{value:"Details",id:"details",level:4},{value:"Cardano-mainnet",id:"cardano-mainnet",level:3},{value:"Overview",id:"overview-1",level:4},{value:"Details:",id:"details-1",level:4},{value:"Cardano-ops (Legacy Mainnet)",id:"cardano-ops-legacy-mainnet",level:3},{value:"Cardano-playground",id:"cardano-playground",level:3},{value:"Overview:",id:"overview-2",level:4},{value:"Details:",id:"details-2",level:4},{value:"Iohk-nix",id:"iohk-nix",level:3},{value:"Devx-ci",id:"devx-ci",level:3},{value:"Cardano-monitoring",id:"cardano-monitoring",level:3}],s={toc:d},m="wrapper";function u(e){let{components:t,...a}=e;return(0,r.kt)(m,(0,n.Z)({},s,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"high-level-summary"},"High level summary"),(0,r.kt)("p",null,"The SRE team continues work on Cardano environment improvements and general maintenance."),(0,r.kt)("p",null,"Some notable recent changes, updates or improvements include:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Preview network was hard forked to Conway era."),(0,r.kt)("li",{parentName:"ul"},"Cardano-db-sync was updated to ",(0,r.kt)("inlineCode",{parentName:"li"},"13.4.0.0")," across all environments.")),(0,r.kt)("h2",{id:"repository-work"},"Repository Work"),(0,r.kt)("h3",{id:"cardano-airgap"},"Cardano Airgap"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/IntersectMBO/cardano-airgap/compare/7dcea34...91ad33a"},"Commit-compare")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Update the image to cardano-cli to ",(0,r.kt)("inlineCode",{parentName:"li"},"9.2.1.0")," and credential-manager to HEAD."),(0,r.kt)("li",{parentName:"ul"},"Finish testing the airgap image using ext4 partitions and add ventoy to the devShell.")),(0,r.kt)("h3",{id:"cardano-parts"},"Cardano Parts"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/input-output-hk/cardano-parts/pull/45"},"Node 9.1.0, Mithril 2430.0, Chang readiness")),(0,r.kt)("h4",{id:"overview"},"Overview"),(0,r.kt)("p",null,"Sets cardano-node (release) and cardano-node-ng (pre-release) versions to 9.1.0\nand mithril to 2430.0. Includes nixosModule improvements for the new tracing\nsystem, a new template-clone recipe, various recipe improvements and fixes. A\nChang readiness query has been added."),(0,r.kt)("h4",{id:"details"},"Details"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Important versioning updates:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"cardano-node and cardano-node-ng are now ",(0,r.kt)("inlineCode",{parentName:"li"},"9.1.0")))),(0,r.kt)("li",{parentName:"ul"},"Bumps capkgs:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"For node releases of ",(0,r.kt)("inlineCode",{parentName:"li"},"9.1.0")),(0,r.kt)("li",{parentName:"ul"},"For mithril ",(0,r.kt)("inlineCode",{parentName:"li"},"2430.0")," and mithril-unstable"))),(0,r.kt)("li",{parentName:"ul"},"Improves the ",(0,r.kt)("inlineCode",{parentName:"li"},"profile-cardano-node-new-tracing")," nixosModule and new tracing system in general by better cleaning residual legacy config items, restructuring the options for more flexibility in config composition, and configuring the new tracing system to log close to parity volume with the legacy tracing system when using UTXO-HD in memory mode."),(0,r.kt)("li",{parentName:"ul"},"Adds additional default Tcp and TcpExt metrics to the ",(0,r.kt)("inlineCode",{parentName:"li"},"profile-grafana-agent")," nixosModules metrics scrape list"),(0,r.kt)("li",{parentName:"ul"},"Adds ",(0,r.kt)("inlineCode",{parentName:"li"},"curl")," and the ",(0,r.kt)("inlineCode",{parentName:"li"},"pre-push")," script to the default cardano-parts devShell"),(0,r.kt)("li",{parentName:"ul"},"Adds template alert ",(0,r.kt)("inlineCode",{parentName:"li"},"cardano_node_elevated_restarts")),(0,r.kt)("li",{parentName:"ul"},"Adds a new template recipe of ",(0,r.kt)("inlineCode",{parentName:"li"},"template-clone")," for when downstream users know they simply want to mirror upstream templates rather than diff or patch them"),(0,r.kt)("li",{parentName:"ul"},"Adds a new template sql script with a Chang era readiness sql query"),(0,r.kt)("li",{parentName:"ul"},"Improves template recipe ",(0,r.kt)("inlineCode",{parentName:"li"},"dbsync-pool-analyze")," and sql query with parameters to query any CTE in the large ",(0,r.kt)("inlineCode",{parentName:"li"},"dbsync-pool-perf")," sql from cli"),(0,r.kt)("li",{parentName:"ul"},"Improves template recipe ",(0,r.kt)("inlineCode",{parentName:"li"},"dbsync-pool-analyze")," to handle queries that result in no non-performing pools"),(0,r.kt)("li",{parentName:"ul"},"Improves template recipe ",(0,r.kt)("inlineCode",{parentName:"li"},"dedelegate-pools")," with a mempool query instead of a fixed time to handle UTxO on-chain settlement"),(0,r.kt)("li",{parentName:"ul"},"Removes template recipes that are now mostly cardano-playground specific"),(0,r.kt)("li",{parentName:"ul"},"Fixes template dashboard for cardano-node legacy and new tracing application metrics to always show the full environment KES period"),(0,r.kt)("li",{parentName:"ul"},"Fixes template recipe ",(0,r.kt)("inlineCode",{parentName:"li"},"apply-bootstrap")),(0,r.kt)("li",{parentName:"ul"},"Fixes outdated service option name and db-sync snapshot schema description")),(0,r.kt)("h3",{id:"cardano-mainnet"},"Cardano-mainnet"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/input-output-hk/cardano-mainnet/pull/18"},"Node 9.1.0, Mithril 2430.0, Bp scheduled restart module"),"\n",(0,r.kt)("a",{parentName:"p",href:"https://github.com/input-output-hk/cardano-mainnet/pull/19"},"Schedule restart initial prototyping")),(0,r.kt)("h4",{id:"overview-1"},"Overview"),(0,r.kt)("p",null,"Sets cardano-node version to ",(0,r.kt)("inlineCode",{parentName:"p"},"9.1.0")," and mithril to ",(0,r.kt)("inlineCode",{parentName:"p"},"2430.0"),". Adds block\nproducer scheduled restart capability."),(0,r.kt)("h4",{id:"details-1"},"Details:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Bumps cardano-parts for:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Important versioning updates:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"cardano-node and cardano-node-ng are now ",(0,r.kt)("inlineCode",{parentName:"li"},"9.1.0")))),(0,r.kt)("li",{parentName:"ul"},"Capkgs updates:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"For node releases of ",(0,r.kt)("inlineCode",{parentName:"li"},"9.1.0")),(0,r.kt)("li",{parentName:"ul"},"For mithril ",(0,r.kt)("inlineCode",{parentName:"li"},"2430.0")," and mithril-unstable"))))),(0,r.kt)("li",{parentName:"ul"},"KES rotates mainnet block producers"),(0,r.kt)("li",{parentName:"ul"},"Optimizes bootstrap nodes for ",(0,r.kt)("inlineCode",{parentName:"li"},"-N4")," RTS usage"),(0,r.kt)("li",{parentName:"ul"},"Adds ",(0,r.kt)("inlineCode",{parentName:"li"},"cardano-node-schedule-restart")," nixosModule and associated perSystem packages"),(0,r.kt)("li",{parentName:"ul"},"Adds new alerts for ",(0,r.kt)("inlineCode",{parentName:"li"},"cardano_node_elevated_restarts")),(0,r.kt)("li",{parentName:"ul"},"Fixes dashboard for ",(0,r.kt)("inlineCode",{parentName:"li"},"cardano-node")," legacy and new tracing application metrics to always show the full environment KES period")),(0,r.kt)("h3",{id:"cardano-ops-legacy-mainnet"},"Cardano-ops (Legacy Mainnet)"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/input-output-hk/cardano-ops/compare/50a9825...825d35c"},"Commit-compare")),(0,r.kt)("p",null,"Over a two week period the legacy relay nodes were scaled down to running only\none instance of cardano-node per machine and then the number of running\nmachines was further reduced by 25%."),(0,r.kt)("h3",{id:"cardano-playground"},"Cardano-playground"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/input-output-hk/cardano-playground/pull/29"},"Node 9.1.0, Mithril 2430.0, Preview hardfork to Conway")),(0,r.kt)("h4",{id:"overview-2"},"Overview:"),(0,r.kt)("p",null,"Sets cardano-node (release) and cardano-node-ng (pre-release) versions to\n",(0,r.kt)("inlineCode",{parentName:"p"},"9.1.0")," and mithril to ",(0,r.kt)("inlineCode",{parentName:"p"},"2430.0"),". Hard forks preview network to Conway. Adds\nrecipe and other improvements, including to the pool performance query recipe\ninterface and a Chang readiness query."),(0,r.kt)("h4",{id:"details-2"},"Details:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Bumps cardano-parts for:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Important versioning updates:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"cardano-node and cardano-node-ng are now ",(0,r.kt)("inlineCode",{parentName:"li"},"9.1.0")))),(0,r.kt)("li",{parentName:"ul"},"Capkgs updates:",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"For node releases of ",(0,r.kt)("inlineCode",{parentName:"li"},"9.1.0")),(0,r.kt)("li",{parentName:"ul"},"For mithril ",(0,r.kt)("inlineCode",{parentName:"li"},"2430.0")," and mithril-unstable"))))),(0,r.kt)("li",{parentName:"ul"},"Adds a new template sql script with a Chang era readiness sql query"),(0,r.kt)("li",{parentName:"ul"},"Adds a babbage-to-conway cost model to the Cardano book"),(0,r.kt)("li",{parentName:"ul"},"Adds a new recipe ",(0,r.kt)("inlineCode",{parentName:"li"},"kes-rotate")," for easy kes rotation"),(0,r.kt)("li",{parentName:"ul"},"Adds new alerts for ",(0,r.kt)("inlineCode",{parentName:"li"},"cardano_node_elevated_restarts")),(0,r.kt)("li",{parentName:"ul"},"Adds a commit stamp marker for Cardano book updates"),(0,r.kt)("li",{parentName:"ul"},"Adds a new ",(0,r.kt)("inlineCode",{parentName:"li"},"template-clone")," recipe for mirroring upstream template files when diffing or patching isn't needed"),(0,r.kt)("li",{parentName:"ul"},"Updates the Cardano book environment for cardano-node ",(0,r.kt)("inlineCode",{parentName:"li"},"9.1.0")),(0,r.kt)("li",{parentName:"ul"},"Updates the explainer docs for kes-rotation, chain-manipulation, new-network"),(0,r.kt)("li",{parentName:"ul"},"Updates the preview faucet for new govtool operations"),(0,r.kt)("li",{parentName:"ul"},"Rotates sanchonet KES, resizes the metadata server"),(0,r.kt)("li",{parentName:"ul"},"Investigates mempool rejections with new tracing system and modified logging"),(0,r.kt)("li",{parentName:"ul"},"Tests a comparison set of machines in mainnet environment for node ",(0,r.kt)("inlineCode",{parentName:"li"},"9.1.0")," and ",(0,r.kt)("inlineCode",{parentName:"li"},"utxo-hd-9.0")),(0,r.kt)("li",{parentName:"ul"},"Tests a new tracing system branch for metrics renaming and KES metrics update calculations"),(0,r.kt)("li",{parentName:"ul"},"Moves some cardano-playground specific recipes to the ",(0,r.kt)("inlineCode",{parentName:"li"},"scripts/recipes-custom.just")," module"),(0,r.kt)("li",{parentName:"ul"},"Improves template recipe ",(0,r.kt)("inlineCode",{parentName:"li"},"dbsync-pool-analyze")," and sql query with parameters to query any CTE in the large ",(0,r.kt)("inlineCode",{parentName:"li"},"dbsync-pool-perf")," sql from cli"),(0,r.kt)("li",{parentName:"ul"},"Improves template recipe ",(0,r.kt)("inlineCode",{parentName:"li"},"dbsync-pool-analyze")," to handle queries that result in no non-performing pools"),(0,r.kt)("li",{parentName:"ul"},"Improves template recipe ",(0,r.kt)("inlineCode",{parentName:"li"},"dedelegate-pools")," with a mempool query instead of a fixed time to handle UTxO on-chain settlement"),(0,r.kt)("li",{parentName:"ul"},"Hard forks preview environment to Conway and resizes one relay member of each preview pool group")),(0,r.kt)("h3",{id:"iohk-nix"},"Iohk-nix"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/input-output-hk/iohk-nix/pull/586"},"Add conway config for mainnet/preprod/preview")),(0,r.kt)("h3",{id:"devx-ci"},"Devx-ci"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/input-output-hk/devx-ci/commit/8e1eebb6bfaf4f1aa46347564581a3cf08245ec6"},"Fix Hydra alerting immediately on no data")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Migrate from Grafana Cloud to our self-hosted cardano-monitoring stack",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Do not filter metrics to keep down number of unique series"),(0,r.kt)("li",{parentName:"ul"},"This allows unlimited collection of metrics from our CI machines for better alerts and measurements for ongoing performance tuning."))),(0,r.kt)("li",{parentName:"ul"},"Upgrade disko partition names manually on remaining machines ci{2,3,4,6,7,8} so boot does not break on the next deployment"),(0,r.kt)("li",{parentName:"ul"},"Grafana dashboard: fix memory usage graph"),(0,r.kt)("li",{parentName:"ul"},"Add alerts")),(0,r.kt)("h3",{id:"cardano-monitoring"},"Cardano-monitoring"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/input-output-hk/cardano-monitoring/compare/75b25ad...2c0b022"},"Commit-compare")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Add preliminary support for Loki for log collection")))}u.isMDXComponent=!0}}]);